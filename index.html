<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í†µí•© ê¸ˆìœµ ê°€ì´ë“œ ë° ê³„ì‚°ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .guide-container {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .guide-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2c3e50;
        }

        .guide-h1 {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .guide-subtitle {
            font-size: 13px;
            color: #7f8c8d;
        }

        .guide-section {
            margin-bottom: 25px;
        }

        .guide-h2 {
            font-size: 16px;
            font-weight: 700;
            background-color: #34495e;
            color: white;
            padding: 10px 15px;
            margin-bottom: 12px;
            border-radius: 4px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
        }

        .info-item {
            background-color: #ecf0f1;
            padding: 12px;
            border-left: 4px solid #3498db;
            border-radius: 3px;
        }

        .info-label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 12px;
            display: block;
            margin-bottom: 4px;
        }

        .info-value {
            color: #27ae60;
            font-size: 13px;
            font-weight: 500;
        }

        .info-value.alert {
            color: #e74c3c;
        }

        .guide-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }

        .guide-table thead {
            background-color: #34495e;
            color: white;
        }

        .guide-table th {
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            border: 1px solid #bdc3c7;
        }

        .guide-table td {
            padding: 9px 8px;
            border: 1px solid #ecf0f1;
        }

        .guide-table tbody tr:nth-child(odd) {
            background-color: #f9f9f9;
        }

        .note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px 12px;
            margin: 10px 0;
            border-radius: 3px;
            font-size: 12px;
            color: #856404;
        }

        .tag {
            display: inline-block;
            background-color: #e8f4f8;
            color: #2980b9;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-right: 5px;
        }
    </style>
</head>
<body class="bg-slate-50">
    <div class="max-w-7xl mx-auto">
        <!-- ìƒë‹¨ ë°°ë„ˆ ì„¹ì…˜ -->
        <div class="p-4 md:p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <!-- ë…¸ì…˜ ë°”ë¡œê°€ê¸° ë°°ë„ˆ -->
                <a href="https://www.notion.so/1f2ebdf111b580cdbefbe40390c5428c?v=1f2ebdf111b581229457000c8a053910" target="_blank" rel="noopener noreferrer" class="block">
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow h-40 flex flex-col justify-between text-white">
                        <div>
                            <div class="text-sm font-semibold opacity-90 mb-2">ğŸ“š ë¬¸ì„œ</div>
                            <h3 class="text-2xl font-bold">ë…¸ì…˜ ë°”ë¡œê°€ê¸°</h3>
                        </div>
                        <div class="text-sm opacity-90">ë°”ë¡œê°€ê¸° â†’</div>
                    </div>
                </a>

                <!-- LTV ê³„ì‚°ê¸° ë°°ë„ˆ -->
                <a href="https://ltv-flask-young.onrender.com/" target="_blank" rel="noopener noreferrer" class="block">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow h-40 flex flex-col justify-between text-white">
                        <div>
                            <div class="text-sm font-semibold opacity-90 mb-2">ê¸ˆìœµ ë„êµ¬</div>
                            <h3 class="text-2xl font-bold">LTVê³„ì‚°ê¸°</h3>
                        </div>
                        <div class="text-sm opacity-90">ë°”ë¡œê°€ê¸° â†’</div>
                    </div>
                </a>

                <!-- ë¡ í”„ë¼ì „ì‚° ë°°ë„ˆ -->
                <a href="https://app.loanfra.com/self_screening" target="_blank" rel="noopener noreferrer" class="block">
                    <div class="bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow h-40 flex flex-col justify-between text-white">
                        <div>
                            <div class="text-sm font-semibold opacity-90 mb-2">ì „ì‚° ì‹œìŠ¤í…œ</div>
                            <h3 class="text-2xl font-bold">ë¡ í”„ë¼ì „ì‚°</h3>
                        </div>
                        <div class="text-sm opacity-90">ë°”ë¡œê°€ê¸° â†’</div>
                    </div>
                </a>
            </div>

            <!-- ë¹ ë¥¸ ì´ë™ ì¹´ë“œ -->
            <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 mb-6">
                <h4 class="font-semibold text-slate-800 mb-4 text-lg">ğŸ“‘ ë¹ ë¥¸ ì´ë™</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="switchTab('calculator'); return false;" class="px-6 py-3 bg-blue-50 text-blue-600 hover:bg-blue-100 font-medium rounded-xl transition border border-blue-200 cursor-pointer">ë‹¤ê¸°ëŠ¥ ê³„ì‚°ê¸°</button>
                    <button onclick="switchTab('guide1'); return false;" class="px-6 py-3 bg-blue-50 text-blue-600 hover:bg-blue-100 font-medium rounded-xl transition border border-blue-200 cursor-pointer">í¬ë§ë‹´ë³´ ê°€ì´ë“œ</button>
                    <button onclick="switchTab('guide2'); return false;" class="px-6 py-3 bg-blue-50 text-blue-600 hover:bg-blue-100 font-medium rounded-xl transition border border-blue-200 cursor-pointer">ê°œì¸ì •ë³´ ê´€ë¦¬</button>
                </div>
            </div>
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="p-4 md:p-6">
            <!-- íƒ­ 1: ë‹¤ê¸°ëŠ¥ ê³„ì‚°ê¸° -->
            <div id="calculator" class="tab-content active">
                <div class="bg-white rounded-lg p-6 md:p-8">
                    <h1 class="text-2xl md:text-3xl font-bold mb-6">í†µí•© ê³„ì‚°ê¸°</h1>

                    <!-- ë¶€ê°€ì„¸ ê³„ì‚°ê¸° -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">ë¶€ê°€ì„¸ ê³„ì‚°ê¸°</h2>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">ë¶€ê°€ì„¸ í¬í•¨ ê¸ˆì•¡ ì…ë ¥</label>
                            <input type="text" id="vatInput" oninput="calculateVAT()" class="w-full border rounded-xl px-3 py-2" />
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">ê³µê¸‰ê°€ì•¡</label>
                            <input type="text" id="supplyAmount" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">ë¶€ê°€ì„¸</label>
                            <input type="text" id="vatOutput" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>
                        <button onclick="resetVAT()" class="px-4 py-2 rounded-xl bg-blue-500 text-white hover:bg-blue-600 transition">ë¶€ê°€ì„¸ ì´ˆê¸°í™”</button>
                    </div>

                    <!-- ë‚ ì§œ ê³„ì‚°ê¸° -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">ë‚ ì§œ ê³„ì‚°ê¸°</h2>

                        <!-- ë‚ ì§œì— ì¼ìˆ˜ ë”í•˜ê¸° -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3 text-slate-700">1. ë‚ ì§œì— ì¼ìˆ˜ ë”í•˜ê¸°</h3>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">ì‹œì‘ ë‚ ì§œ</label>
                                <input type="date" id="dateStart" oninput="calculateDateAddition()" class="w-full border rounded-xl px-3 py-2" />
                            </div>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">ë”í•  ì¼ìˆ˜ (ì¼)</label>
                                <input type="number" id="daysToAdd" oninput="calculateDateAddition()" class="w-full border rounded-xl px-3 py-2" placeholder="ì˜ˆ: 10" />
                            </div>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">ê²°ê³¼ ë‚ ì§œ</label>
                                <input type="text" id="dateResult" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                            </div>
                            <button onclick="resetDateAddition()" class="px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition">ì´ˆê¸°í™”</button>
                        </div>

                        <hr class="my-6 border-slate-200" />

                        <!-- ë‘ ë‚ ì§œ ì‚¬ì´ ì¼ìˆ˜ ê³„ì‚° -->
                        <div>
                            <h3 class="text-lg font-semibold mb-3 text-slate-700">2. ë‘ ë‚ ì§œ ì‚¬ì´ì˜ ì¼ìˆ˜ ê³„ì‚°</h3>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">ì‹œì‘ ë‚ ì§œ</label>
                                <input type="date" id="dateFrom" oninput="calculateDateDifference()" class="w-full border rounded-xl px-3 py-2" />
                            </div>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">ì¢…ë£Œ ë‚ ì§œ</label>
                                <input type="date" id="dateTo" oninput="calculateDateDifference()" class="w-full border rounded-xl px-3 py-2" />
                            </div>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">ì¼ìˆ˜</label>
                                <input type="text" id="dateDifference" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                            </div>
                            <button onclick="resetDateDifference()" class="px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition">ì´ˆê¸°í™”</button>
                        </div>
                    </div>

                    <!-- ê³µê¸‰ìë³„ ìë™ê¸ˆì•¡ í•©ì‚°ê¸° -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">ê³µê¸‰ìë³„ ìë™ê¸ˆì•¡ í•©ì‚°ê¸°</h2>
                        <button onclick="addSupplier()" class="px-4 py-2 rounded-xl bg-blue-500 text-white hover:bg-blue-600 transition mb-4">ê³µê¸‰ì ì¶”ê°€ +</button>
                        <div id="suppliers-container"></div>
                    </div>

                    <!-- ê³µê¸‰ì ë¶„ë°°ê¸ˆ ê³„ì‚°ê¸° -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">ê³µê¸‰ì ë¶„ë°°ê¸ˆ ê³„ì‚°ê¸°</h2>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">ì´ ë¶„ë°° ê¸ˆì•¡</label>
                            <input type="text" id="manualTotal" oninput="updateDistribution()" class="w-full border rounded-xl px-3 py-2" />
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">ê³µê¸‰ì ìˆ˜</label>
                            <div class="flex items-center gap-2">
                                <button onclick="changeSupplierCount(-1)" class="w-10 h-10 bg-slate-200 rounded-lg font-bold hover:bg-slate-300">âˆ’</button>
                                <input type="number" id="supplierCount" value="2" oninput="updateSupplierCount()" class="w-16 border rounded-xl px-2 py-1 text-center" />
                                <button onclick="changeSupplierCount(1)" class="w-10 h-10 bg-slate-200 rounded-lg font-bold hover:bg-slate-300">+</button>
                            </div>
                        </div>
                        <table class="w-full mb-4 border-collapse">
                            <thead class="bg-slate-100">
                                <tr>
                                    <th class="p-3 text-left">ê³µê¸‰ì</th>
                                    <th class="p-3 text-left">ìˆ˜ê¸° ì…ë ¥ ê¸ˆì•¡</th>
                                    <th class="p-3 text-left">ìë™ ê³„ì‚° ê¸ˆì•¡ ì›</th>
                                </tr>
                            </thead>
                            <tbody id="distribution-table"></tbody>
                        </table>
                        <div id="distribution-summary" class="text-sm text-slate-600 mb-4"></div>
                        <button onclick="resetManualInputs()" class="px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition">ìˆ˜ê¸°ì…ë ¥ ì´ˆê¸°í™”</button>
                    </div>

                    <!-- ì›ê¸ˆ í¼ì„¼íŠ¸Â·ë§Œê¸°ì¼ì‹œ ëŒ€ì¶œ ê³„ì‚°ê¸° -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-bold pb-2 border-b flex-1">ì›ê¸ˆ í¼ì„¼íŠ¸Â·ë§Œê¸°ì¼ì‹œ ëŒ€ì¶œ ê³„ì‚°ê¸°</h2>
                            <button onclick="resetLoanCalc()" class="px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition ml-4">ì´ˆê¸°í™”</button>
                        </div>
                        <p class="text-sm md:text-base text-slate-600 mb-6">
                            ëŒ€ì¶œ ì›ê¸ˆì˜ <b>X%</b>ë§Œ ê¸°ê°„ ë™ì•ˆ ë§¤ì›” ë¶„í•  ìƒí™˜í•˜ê³ , ë‚˜ë¨¸ì§€ <b>(1âˆ’X%)</b>ëŠ” ë§Œê¸°ì¼ì— ì¼ì‹œ ìƒí™˜í•˜ëŠ” êµ¬ì¡°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
                        </p>

                        <div class="grid md:grid-cols-2 gap-4 mb-6">
                            <label class="flex flex-col gap-2 bg-white rounded-2xl p-4 shadow-sm border">
                                <span class="text-sm text-slate-600">ëŒ€ì¶œê¸ˆ (ì›)</span>
                                <input type="text" id="loan" class="border rounded-xl px-3 py-2" oninput="handleLoanInput(event)" placeholder="ì˜ˆ: 300,000,000" />
                            </label>
                            <label class="flex flex-col gap-2 bg-white rounded-2xl p-4 shadow-sm border">
                                <span class="text-sm text-slate-600">ì—°ì´ìœ¨ (%)</span>
                                <input type="number" id="annualRate" class="border rounded-xl px-3 py-2" oninput="calculateLoan()" min="0" step="0.01" placeholder="ì˜ˆ: 4.8" />
                            </label>
                            <label class="flex flex-col gap-2 bg-white rounded-2xl p-4 shadow-sm border">
                                <span class="text-sm text-slate-600">ì›ê¸ˆ ë¶„í•  ë¹„ìœ¨ (X%)</span>
                                <input type="number" id="principalPct" class="border rounded-xl px-3 py-2" oninput="calculateLoan()" min="0" max="100" step="0.1" placeholder="ì˜ˆ: 7" />
                            </label>
                            <label class="flex flex-col gap-2 bg-white rounded-2xl p-4 shadow-sm border">
                                <span class="text-sm text-slate-600">ê¸°ê°„ (ê°œì›”)</span>
                                <input type="number" id="months" class="border rounded-xl px-3 py-2" oninput="calculateLoan()" min="1" step="1" placeholder="ì˜ˆ: 60" />
                                <span id="monthsError" class="text-xs text-red-600 hidden">ê¸°ê°„(ê°œì›”)ì€ 1 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.</span>
                            </label>
                        </div>

                        <div class="grid md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-1">ë§¤ì›” ì›ê¸ˆ</div>
                                <div id="monthlyPrincipal" class="text-xl font-semibold text-slate-400">- ì›</div>
                            </div>
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-1">ì²« ë‹¬ ë‚©ì…ì•¡</div>
                                <div id="firstMonthPayment" class="text-xl font-semibold text-slate-400">- ì›</div>
                                <div id="firstMonthBreakdown" class="text-xs text-slate-500">(ì›ê¸ˆ + ì´ì)</div>
                            </div>
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-1">ë§Œê¸°ì›” ë‚©ì…ì•¡</div>
                                <div id="finalMonthPayment" class="text-xl font-semibold text-slate-400">- ì›</div>
                                <div id="finalMonthBreakdown" class="text-xs text-slate-500">(ì›ê¸ˆ + ì´ì)</div>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-4 mb-6">
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-2">êµ¬ì„±</div>
                                <ul class="text-sm leading-7 list-disc pl-5">
                                    <li>ê¸°ê°„ ì¤‘ ë¶„í•  ìƒí™˜ ì›ê¸ˆ í•©ê³„: <b id="principalPortion" class="text-slate-400">- ì›</b></li>
                                    <li>ë§¤ì›” ê³ ì • ì›ê¸ˆ: <b id="monthlyPrincipalFixed" class="text-slate-400">- ì›</b></li>
                                    <li>ë§Œê¸° ì¼ì‹œìƒí™˜ ì›ê¸ˆ(ì”ì•¡): <b id="finalBalloonPrincipal" class="text-slate-400">- ì›</b></li>
                                </ul>
                            </div>
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-2">ìš”ì•½</div>
                                <ul class="text-sm leading-7 list-disc pl-5">
                                    <li>ì›” ì´ììœ¨: <span id="monthlyRate" class="text-slate-400">-%</span></li>
                                    <li>ì´ ì´ì(ì¶”ì •): <b id="totalInterest" class="text-slate-400">- ì›</b></li>
                                    <li>ì´ ë‚©ë¶€ì•¡(ì›ê¸ˆ+ì´ì): <b id="totalPaid" class="text-slate-400">- ì›</b></li>
                                </ul>
                            </div>
                        </div>

                        <button onclick="toggleLoanSchedule()" class="px-4 py-2 rounded-xl bg-slate-900 text-white hover:opacity-90 transition">ìƒí™˜ ìŠ¤ì¼€ì¤„ ë³´ê¸°</button>

                        <div id="scheduleContainer" class="hidden overflow-x-auto mt-4 bg-white rounded-2xl shadow-sm border border-slate-200">
                            <table class="min-w-full text-sm">
                                <thead class="bg-slate-100">
                                    <tr>
                                        <th class="p-3 text-left">ì›”</th>
                                        <th class="p-3 text-right">ì›”ì´ˆ ì”ì•¡</th>
                                        <th class="p-3 text-right">ì›ê¸ˆ</th>
                                        <th class="p-3 text-right">ì´ì</th>
                                        <th class="p-3 text-right">ë‚©ì…ì•¡</th>
                                        <th class="p-3 text-right">ì›”ë§ ì”ì•¡</th>
                                    </tr>
                                </thead>
                                <tbody id="scheduleBody"></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- ì´ì ê³„ì‚°ê¸° -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">ì´ì ê³„ì‚°ê¸°</h2>

                        <div id="dailyRateDisplay" class="hidden mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm text-blue-800"></div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">ëŒ€ì¶œê¸ˆì•¡ (ë§Œì›)</label>
                            <input type="text" id="loanAmount" oninput="calculateInterest()" class="w-full border rounded-xl px-3 py-2" />
                        </div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">ì—°ì´ìœ¨ (%)</label>
                            <input type="text" id="annualRate2" oninput="calculateInterest()" class="w-full border rounded-xl px-3 py-2" />
                        </div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">ì´ì ê³„ì‚° ì—° ìˆ˜ (ë…„)</label>
                            <input type="number" id="years" value="1" oninput="calculateInterest()" class="w-full border rounded-xl px-3 py-2" />
                        </div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">í•˜ë£¨ ì´ì</label>
                            <input type="text" id="dailyInterest" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">í•œë‹¬ ì´ì</label>
                            <input type="text" id="monthlyInterest" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>

                        <div class="mb-4">
                            <label id="yearlyLabel" class="block mb-2 font-semibold">1ë…„ ì´ì</label>
                            <input type="text" id="yearlyInterest" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>

                        <button onclick="resetInterest()" class="px-4 py-2 rounded-xl bg-blue-500 text-white hover:bg-blue-600 transition">ì´ì ì´ˆê¸°í™”</button>
                    </div>
                </div>
            </div>

            <!-- íƒ­ 2: í¬ë§ë‹´ë³´ ê°€ì´ë“œ -->
            <div id="guide1" class="tab-content">
                <div class="guide-container max-w-4xl mx-auto bg-white rounded-lg p-6 md:p-8">
                    <div class="guide-header">
                        <h1 class="guide-h1">í¬ë§ë‹´ë³´</h1>
                        <p class="guide-subtitle">ëŒ€ì¶œ ìƒí’ˆ ê°€ì´ë“œë¼ì¸ (ìµœì¢… ì—…ë°ì´íŠ¸)</p>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">ğŸ“‹ ê¸°ë³¸ ìƒí’ˆ ì •ë³´</h2>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">ìƒí’ˆëª…</span>
                                <span class="info-value">í¬ë§ë‹´ë³´</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ëŒ€ì¶œê¸°ê°„</span>
                                <span class="info-value">2ë…„</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ëŒ€ì¶œëŒ€ìƒ</span>
                                <span class="info-value">ì•„íŒŒíŠ¸ ë° ì£¼ìƒë³µí•©ì•„íŒŒíŠ¸</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ì·¨ê¸‰ ê°€ëŠ¥ ì§€ì—­</span>
                                <span class="info-value">ì„œìš¸, ê²½ê¸°ë„, ì¸ì²œ</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ì‹ ìš©ì ìˆ˜</span>
                                <span class="info-value">ì»¤íŠ¸ë¼ì¸ ì—†ìŒ<span class="tag">ë‹¨, ì—°ì²´ì ë¶ˆê°€</span></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ì†Œë“ ì‹¬ì‚¬</span>
                                <span class="info-value">ë³¸ì¸/ë°°ìš°ì/ê¸°íƒ€ ì†Œë“ ì¤‘ìš”</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ìƒí™˜ë°©ì‹</span>
                                <span class="info-value">ë§Œê¸°ì¼ì‹œìƒí™˜</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ì¤‘ë„ìƒí™˜ìˆ˜ìˆ˜ë£Œ</span>
                                <span class="info-value">3%</span>
                            </div>
                        </div>

                        <h3 style="font-size: 13px; color: #2c3e50; margin: 12px 0 8px; font-weight: 600;">ê¸ˆë¦¬</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">ëŒ€ì¶œê¸ˆë¦¬</span>
                                <span class="info-value">10.9% (ì˜ˆì™¸) / 11.9 ~ 13.9%</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">ì—°ì²´ê¸ˆë¦¬</span>
                                <span class="info-value alert">ëŒ€ì¶œê¸ˆë¦¬ + 3.0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">ğŸ“Š ì‹œì„¸ ì ìš© ê¸°ì¤€</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th style="width: 30%;">êµ¬ë¶„</th>
                                    <th>ì ìš© ê¸°ì¤€</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>í•˜í•œê°€</strong></td>
                                    <td>1~2ì¸ì¸µ</td>
                                </tr>
                                <tr>
                                    <td><strong>ì¼ë°˜ê°€</strong></td>
                                    <td>ê·¸ ì™¸ì¸ì¸µ</td>
                                </tr>
                                <tr>
                                    <td><strong>ì‹œì„¸ ì¶œì²˜</strong></td>
                                    <td>KBì‹œì„¸ ìš°ì„  ì ìš©, ë¶€ë™ì‚°í…Œí¬ ì ìš©</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">ğŸ’° LTV ë° ê¸ˆë¦¬</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th style="width: 30%;">êµ¬ë¶„</th>
                                    <th style="width: 35%;">LTV ë²”ìœ„</th>
                                    <th>ì¸ì¸µë³„ ì ìš©</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>ì„ ìˆœìœ„</strong></td>
                                    <td>80%</td>
                                    <td>ì „ì²´</td>
                                </tr>
                                <tr>
                                    <td><strong>í›„ìˆœìœ„</strong></td>
                                    <td>80%</td>
                                    <td>ì „ì²´</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">ğŸ‘¤ ì‚¬ì—…ì ìê²© ì¡°ê±´</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th style="width: 40%;">ì¡°ê±´</th>
                                    <th>í•„ìˆ˜ì—¬ë¶€</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ì¦‰ë°œì‚¬ì—…ì ê°€ëŠ¥</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td><strong>íì—…ì´ ì•„ë‹Œ ê°œì—…ìƒíƒœ</strong></td>
                                    <td><span style="color: #e74c3c; font-weight: 600;">í•„ìˆ˜</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">ğŸ  ì¸ì • ë¶€ë™ì‚° ì¡°ê±´</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th>ì¡°ê±´</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ì†Œìœ ê¶Œì´ì „ 3ê°œì›” ì´í›„ ë¶€ë™ì‚°</td>
                                </tr>
                                <tr>
                                    <td>ì¤€ê³µí›„ 45ë…„ ë¯¸ë§Œ ë° ì‹œì„¸ 3ì–µ ì´ˆê³¼ ë¶€ë™ì‚°</td>
                                </tr>
                                <tr>
                                    <td>ì´ ì„¸ëŒ€ìˆ˜ 100ì„¸ëŒ€ ì´ìƒ ë¶€ë™ì‚°</td>
                                </tr>
                                <tr>
                                    <td>í›„ìˆœìœ„ ì·¨ê¸‰ì‹œ ì„ ìˆœìœ„ ì±„ê¶Œì: <strong>ê¸ˆìœµê¸°ê´€ì— í•œí•¨</strong></td>
                                </tr>
                                <tr>
                                    <td>ë¬¼ìƒë³´ì¦ì¸(ë°°ìš°ì ë° ì§ê³„ì¡´ë¹„ì†) ê°€ëŠ¥</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="note">
                            â€» ê¸ˆìœµê¸°ê´€: ê¸ˆìœµì†Œë¹„ì ë³´í˜¸ì— ê´€í•œ ë²•ë¥  ì œ2ì¡° ì œ6í˜¸ ê¸°ì¤€ ë‚´ì§€ ë§ˆë ¨ ì ìš©
                        </div>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">âŒ ì·¨ê¸‰ ë¶ˆê°€</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th>ì·¨ê¸‰ ë¶ˆê°€ ì‚¬í•­</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ë¶€ë™ì‚°ì—…/ë§¤ë§¤ì—…, ì‚¬ì¹˜í–¥ë½ ë“± ë¶ˆê±´ì „ì—…ì¢… (ë„ë°•, ë§¤ì¶˜, ìœ í¥ì—…ì†Œ ë“±)</td>
                                </tr>
                                <tr>
                                    <td><strong>ì—°ì²´ ë° ì±„ë¬´ë¶ˆì´í–‰ ë“±ì˜ ê³ ê°</strong></td>
                                </tr>
                                <tr>
                                    <td>ì°¨ì£¼ ë° ë‹´ë³´ì±„ê¶Œìì˜ ë²•ì¸ ë˜ëŠ” ì™¸êµ­ì¸ ê²½ìš°</td>
                                </tr>
                                <tr>
                                    <td>ì†Œìœ ê¶Œì— ëŒ€í•œ ê¶Œë¦¬ì¹¨í•´ì˜ ì†Œì§€ê°€ ìˆëŠ” ê²½ìš°</td>
                                </tr>
                                <tr>
                                    <td>ì„¸ëŒ€ ì „ì…ì´ ì—†ëŠ” ê²½ìš°</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="note">
                            â€» ì†Œë“ ì—†ì–´ë„ ê°€ëŠ¥í•˜ë‚˜, ì‹¬ì‚¬ì‹œ ë¶€ê²°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </div>
                    </div>
                </div>
            </div>

            <!-- íƒ­ 3: ê°œì¸ì •ë³´ ê´€ë¦¬ -->
            <div id="guide2" class="tab-content">
                <div class="max-w-4xl mx-auto bg-white rounded-lg p-6 md:p-8">
                    <div style="border-bottom: 3px solid #2c3e50; padding-bottom: 30px; margin-bottom: 40px;">
                        <h1 style="font-size: 32px; color: #2c3e50; margin-bottom: 10px; font-weight: 700;">ê°œì¸ì •ë³´ ë³´ìœ Â·íŒŒê¸° ê´€ë¦¬ ê°€ì´ë“œ</h1>
                        <p style="font-size: 14px; color: #7f8c8d; font-style: italic;">ê¸ˆìœµ íšŒì‚¬ ë‚´ë¶€ êµìœ¡ ë° ì‹¤ë¬´ ë§¤ë‰´ì–¼</p>
                    </div>

                    <h2 style="font-size: 22px; color: #2c3e50; margin-top: 50px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db; font-weight: 700;">1. ê°œì¸ì •ë³´ ë³´ìœ  ê¸°ì¤€</h2>

                    <div style="background-color: #ecf0f1; border-left: 4px solid #27ae60; padding: 20px; margin: 30px 0; border-radius: 4px;">
                        <div style="font-size: 18px; color: #27ae60; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center;">
                            <span style="margin-right: 10px;">ğŸ“‹</span> ê³„ì•½ì´ ì²´ê²°ëœ ê³ ê°
                        </div>
                        <div style="display: grid; gap: 15px;">
                            <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">ë³´ìœ  ê¸°ê°„</div>
                                <div style="color: #444; line-height: 1.6;">ê±°ë˜ ì¢…ë£Œ í›„ <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px; font-weight: 600;">5ë…„</span></div>
                            </div>
                            <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">ê·¼ê±° ë²•ë ¹</div>
                                <div style="color: #444; line-height: 1.6;">ã€Œì‹ ìš©ì •ë³´ì˜ ì´ìš© ë° ë³´í˜¸ì— ê´€í•œ ë²•ë¥ (ì‹ ìš©ì •ë³´ë²•) ì œ20ì¡°ì˜2 ì œ2í•­ ì œ1í˜¸</div>
                            </div>
                        </div>
                    </div>

                    <h2 style="font-size: 22px; color: #2c3e50; margin-top: 50px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #3498db; font-weight: 700;">2. í•µì‹¬ ì›ì¹™: ë¶„ë¦¬ ë³´ê´€ê³¼ ì •ê¸°ì  íŒŒê¸°</h2>

                    <div style="background-color: #f8f9fa; border-left: 4px solid #3498db; padding: 20px; margin: 25px 0; border-radius: 4px;">
                        <h3 style="font-size: 16px; color: #34495e; margin-top: 30px; margin-bottom: 15px; font-weight: 600; display: flex; align-items: center;">
                            <span style="display: inline-block; width: 6px; height: 6px; background-color: #3498db; border-radius: 50%; margin-right: 12px; flex-shrink: 0;"></span>
                            ë°ì´í„° ìƒíƒœ ê´€ë¦¬
                        </h3>
                        <p>ëª¨ë“  ê³ ê° ë°ì´í„°ëŠ” ëª…í™•í•œ ìƒíƒœ ê°’ìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤. ì—‘ì…€ë¡œ ê´€ë¦¬í•˜ë“ , ë³„ë„ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ë“  ì´ êµ¬ë¶„ì´ ëª¨ë“  ì²˜ë¦¬ì˜ ì‹œì‘ì…ë‹ˆë‹¤.</p>
                        <ul style="margin-left: 20px; margin-top: 10px; margin-bottom: 15px;">
                            <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[ì‹¬ì‚¬ì¤‘]</span> - í˜„ì¬ ëŒ€ì¶œ ì‹¬ì‚¬ ì§„í–‰ ì¤‘</li>
                            <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[ê³„ì•½ê³ ê°]</span> - ê³„ì•½ ì²´ê²° ì™„ë£Œ</li>
                            <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[ê±°ë˜ì¢…ë£Œ]</span> - ìƒí™˜ ì™„ë£Œ ë˜ëŠ” ê³„ì•½ ì¢…ë£Œ</li>
                            <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[ì‹¬ì‚¬íƒˆë½]</span> / <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[ì‹ ì²­ì² íšŒ]</span> - ì‹¬ì‚¬ ë¶ˆí†µê³¼ ë˜ëŠ” ê³ ê° ì‹ ì²­ ì² íšŒ</li>
                            <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[ë¶„ìŸì§„í–‰ì¤‘]</span> - ë¯¼ì› ë˜ëŠ” ë¶„ìŸ ì§„í–‰ ì¤‘</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const fmt = new Intl.NumberFormat("ko-KR");
        let showLoanSchedule = false;
        let suppliers = [{ name: "", amounts: [""] }];
        let supplierCountValue = 2;
        let manualInputs = {};

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            const tabContent = document.getElementById(tabName);
            if (tabContent) {
                tabContent.classList.add('active');
            }
        }

        function formatNumberWithCommas(value) {
            return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        function parseFormattedNumber(value) {
            return Number(value.replace(/,/g, '')) || 0;
        }

        function handleLoanInput(event) {
            const input = event.target;
            const cursorPosition = input.selectionStart;
            const oldValue = input.value;
            const oldLength = oldValue.length;
            const numericValue = parseFormattedNumber(input.value);
            const formattedValue = numericValue > 0 ? formatNumberWithCommas(numericValue) : '';
            input.value = formattedValue;
            const newLength = formattedValue.length;
            const lengthDiff = newLength - oldLength;
            const newCursorPosition = cursorPosition + lengthDiff;
            setTimeout(() => {
                input.setSelectionRange(newCursorPosition, newCursorPosition);
            }, 0);
            calculateLoan();
        }

        function resetLoanCalc() {
            document.getElementById('loan').value = '';
            document.getElementById('annualRate').value = '';
            document.getElementById('principalPct').value = '';
            document.getElementById('months').value = '';
            document.getElementById('monthsError').classList.add('hidden');
            resetLoanDisplay();
            if (showLoanSchedule) {
                showLoanSchedule = false;
                document.getElementById('scheduleContainer').classList.add('hidden');
            }
            document.getElementById('scheduleBody').innerHTML = '';
        }

        function resetLoanDisplay() {
            document.getElementById('monthlyPrincipal').innerHTML = '<span class="text-slate-400">- ì›</span>';
            document.getElementById('firstMonthPayment').innerHTML = '<span class="text-slate-400">- ì›</span>';
            document.getElementById('firstMonthBreakdown').innerHTML = '<span class="text-slate-500">(ì›ê¸ˆ + ì´ì)</span>';
            document.getElementById('finalMonthPayment').innerHTML = '<span class="text-slate-400">- ì›</span>';
            document.getElementById('finalMonthBreakdown').innerHTML = '<span class="text-slate-500">(ì›ê¸ˆ + ì´ì)</span>';
            document.getElementById('principalPortion').innerHTML = '<span class="text-slate-400">- ì›</span>';
            document.getElementById('monthlyPrincipalFixed').innerHTML = '<span class="text-slate-400">- ì›</span>';
            document.getElementById('finalBalloonPrincipal').innerHTML = '<span class="text-slate-400">- ì›</span>';
            document.getElementById('monthlyRate').innerHTML = '<span class="text-slate-400">-%</span>';
            document.getElementById('totalInterest').innerHTML = '<span class="text-slate-400">- ì›</span>';
            document.getElementById('totalPaid').innerHTML = '<span class="text-slate-400">- ì›</span>';
        }

        function calculateLoan() {
            const loan = parseFormattedNumber(document.getElementById('loan').value);
            const annualRate = Number(document.getElementById('annualRate').value) || 0;
            const principalPct = Math.max(0, Math.min(100, Number(document.getElementById('principalPct').value) || 0));
            const months = Number(document.getElementById('months').value) || 0;

            if (!loan || !annualRate || !principalPct || !months) {
                resetLoanDisplay();
                return;
            }

            if (months <= 0) {
                document.getElementById('monthsError').classList.remove('hidden');
                resetLoanDisplay();
                return;
            } else {
                document.getElementById('monthsError').classList.add('hidden');
            }

            const monthlyRate = annualRate > 0 ? annualRate / 100 / 12 : 0;
            const principalPortion = loan * (principalPct / 100);
            const monthlyPrincipal = months > 0 ? principalPortion / months : 0;
            const firstMonthInterest = loan * monthlyRate;
            const firstMonthPayment = monthlyPrincipal + firstMonthInterest;
            const balanceBeforeFinal = loan - monthlyPrincipal * Math.max(0, months - 1);
            const finalBalloonPrincipal = loan - principalPortion;
            const finalMonthInterest = balanceBeforeFinal * monthlyRate;
            const finalMonthPrincipal = months > 0 ? monthlyPrincipal + finalBalloonPrincipal : 0;
            const finalMonthPayment = finalMonthPrincipal + finalMonthInterest;

            let totalInterest = 0;
            const schedule = [];

            for (let i = 0; i < Math.max(0, months); i++) {
                const m = i + 1;
                const balAtStart = loan - monthlyPrincipal * i;
                const interest = balAtStart * monthlyRate;
                const principal = m === months ? monthlyPrincipal + finalBalloonPrincipal : monthlyPrincipal;
                const payment = principal + interest;
                const balAtEnd = m === months ? 0 : balAtStart - monthlyPrincipal;
                totalInterest += interest;
                schedule.push({ m, balAtStart, principal, interest, payment, balAtEnd });
            }

            const totalPaid = loan + totalInterest;

            document.getElementById('monthlyPrincipal').textContent = fmt.format(Math.round(monthlyPrincipal)) + ' ì›';
            document.getElementById('firstMonthPayment').textContent = fmt.format(Math.round(firstMonthPayment)) + ' ì›';
            document.getElementById('firstMonthBreakdown').textContent =
                `(ì›ê¸ˆ ${fmt.format(Math.round(monthlyPrincipal))} + ì´ì ${fmt.format(Math.round(firstMonthInterest))})`;
            document.getElementById('finalMonthPayment').textContent = fmt.format(Math.round(finalMonthPayment)) + ' ì›';
            document.getElementById('finalMonthBreakdown').textContent =
                `(ì›ê¸ˆ ${fmt.format(Math.round(finalMonthPrincipal))} + ì´ì ${fmt.format(Math.round(finalMonthInterest))})`;
            document.getElementById('principalPortion').textContent = fmt.format(Math.round(principalPortion)) + ' ì›';
            document.getElementById('monthlyPrincipalFixed').textContent = fmt.format(Math.round(monthlyPrincipal)) + ' ì›';
            document.getElementById('finalBalloonPrincipal').textContent = fmt.format(Math.round(finalBalloonPrincipal)) + ' ì›';
            document.getElementById('monthlyRate').textContent = (monthlyRate * 100 || 0).toFixed(4) + '%';
            document.getElementById('totalInterest').textContent = fmt.format(Math.round(totalInterest)) + ' ì›';
            document.getElementById('totalPaid').textContent = fmt.format(Math.round(totalPaid)) + ' ì›';

            updateScheduleTable(schedule);
        }

        function updateScheduleTable(schedule) {
            const tbody = document.getElementById('scheduleBody');
            tbody.innerHTML = '';
            schedule.forEach(row => {
                const tr = document.createElement('tr');
                tr.className = 'border-t';
                tr.innerHTML = `
                    <td class="p-3">${row.m}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.balAtStart))}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.principal))}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.interest))}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.payment))}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.balAtEnd))}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function toggleLoanSchedule() {
            showLoanSchedule = !showLoanSchedule;
            const container = document.getElementById('scheduleContainer');
            if (showLoanSchedule) {
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        }

        function parseNumber(value) {
            return parseInt((value ?? '').toString().replace(/,/g, "")) || 0;
        }

        function formatNumber(value) {
            const num = parseNumber(value);
            if (num === 0 && (value === "" || value === 0)) return "";
            return num.toLocaleString();
        }

        function sanitizeNumber(value) {
            return value.replace(/[^0-9,]/g, "");
        }

        function sanitizeDecimal(value) {
            return value.replace(/[^0-9.]/g, "");
        }

        function addSupplier() {
            suppliers.push({ name: "", amounts: [""] });
            renderSuppliers();
        }

        function removeSupplier(index) {
            suppliers.splice(index, 1);
            renderSuppliers();
        }

        function updateSupplierName(index, name) {
            suppliers[index].name = name;
            renderSuppliers();
        }

        function updateAmount(supplierIndex, amountIndex, amount) {
            const cleanValue = sanitizeNumber(amount);
            suppliers[supplierIndex].amounts[amountIndex] = cleanValue;
            const inputId = `amount-${supplierIndex}-${amountIndex}`;
            const inputElement = document.getElementById(inputId);
            if (inputElement && document.activeElement !== inputElement) {
                inputElement.value = formatNumber(cleanValue);
            }
            renderSuppliers();
        }

        function addAmountField(supplierIndex) {
            suppliers[supplierIndex].amounts.push("");
            renderSuppliers();
        }

        function removeAmountField(supplierIndex, amountIndex) {
            if (suppliers[supplierIndex].amounts.length > 1) {
                suppliers[supplierIndex].amounts.splice(amountIndex, 1);
                renderSuppliers();
            }
        }

        function getSupplierTotal(amounts) {
            return amounts.reduce((sum, amount) => sum + parseNumber(amount), 0);
        }

        function renderSuppliers() {
            const container = document.getElementById('suppliers-container');
            container.innerHTML = '';
            suppliers.forEach((supplier, supplierIndex) => {
                const supplierDiv = document.createElement('div');
                supplierDiv.className = 'bg-slate-50 rounded-lg p-4 mb-4 border border-slate-200';

                let amountFields = '';
                supplier.amounts.forEach((amount, amountIndex) => {
                    amountFields += `
                        <div class="mb-3">
                            <label class="text-sm text-slate-600">ê¸ˆì•¡</label>
                            <div class="flex gap-2">
                                <input type="text"
                                       id="amount-${supplierIndex}-${amountIndex}"
                                       value="${formatNumber(amount)}"
                                       oninput="updateAmount(${supplierIndex}, ${amountIndex}, this.value)"
                                       class="flex-1 border rounded-lg px-3 py-2"
                                       placeholder="ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”">
                                ${supplier.amounts.length > 1 ?
                                    `<button onclick="removeAmountField(${supplierIndex}, ${amountIndex})" class="px-3 py-2 bg-red-500 text-white rounded-lg text-sm hover:bg-red-600">ì‚­ì œ</button>` :
                                    ''
                                }
                            </div>
                        </div>
                    `;
                });

                supplierDiv.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex-1">
                            <label class="text-sm text-slate-600">ê³µê¸‰ìëª…</label>
                            <input type="text"
                                   value="${supplier.name}"
                                   oninput="updateSupplierName(${supplierIndex}, this.value)"
                                   class="w-full border rounded-lg px-3 py-2"
                                   placeholder="ê³µê¸‰ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>
                        ${suppliers.length > 1 ?
                            `<button onclick="removeSupplier(${supplierIndex})" class="ml-2 mt-6 px-3 py-2 bg-red-500 text-white rounded-lg text-sm hover:bg-red-600">ê³µê¸‰ì ì‚­ì œ</button>` :
                            ''
                        }
                    </div>
                    ${amountFields}
                    <button onclick="addAmountField(${supplierIndex})" class="text-sm px-3 py-1 bg-slate-300 rounded-lg hover:bg-slate-400">
                        ê¸ˆì•¡ í•„ë“œ ì¶”ê°€
                    </button>
                    <div class="mt-3 p-2 bg-blue-50 rounded-lg border border-blue-200">
                        <span class="font-semibold text-blue-900">${supplier.name || "ê³µê¸‰ì"} í•©ê³„: ${getSupplierTotal(supplier.amounts).toLocaleString()} ì›</span>
                    </div>
                `;

                container.appendChild(supplierDiv);
            });
        }

        function getDistSuppliers() {
            return Array.from({ length: supplierCountValue }, (_, i) => String.fromCharCode(65 + i));
        }

        function getFinalAmount(key) {
            const base = parseNumber(document.getElementById('manualTotal').value);
            const distSuppliers = getDistSuppliers();
            const manualKeys = distSuppliers.filter(k => manualInputs[k] && manualInputs[k] !== "");
            const manualSum = manualKeys.reduce((sum, k) => sum + parseNumber(manualInputs[k]), 0);
            const remaining = base - manualSum;
            const autoCount = supplierCountValue - manualKeys.length;

            if (manualInputs[key] && manualInputs[key] !== "") {
                return parseNumber(manualInputs[key]);
            } else if (autoCount > 0) {
                return Math.floor(remaining / autoCount);
            } else {
                return 0;
            }
        }

        function getTotalDistributed() {
            return getDistSuppliers().reduce((sum, key) => sum + getFinalAmount(key), 0);
        }

        function updateDistribution() {
            const input = document.getElementById('manualTotal');
            const rawValue = input.value;
            input.value = formatNumber(rawValue);
            renderDistributionTable();
        }

        function changeSupplierCount(delta) {
            const newCount = Math.max(1, Math.min(26, supplierCountValue + delta));
            document.getElementById('supplierCount').value = newCount;
            updateSupplierCount();
        }

        function updateSupplierCount() {
            const input = document.getElementById('supplierCount');
            const val = parseInt(input.value.replace(/[^0-9]/g, ""), 10);
            if (!isNaN(val) && val >= 1 && val <= 26) {
                supplierCountValue = val;
                updateManualInputsForNewCount();
                renderDistributionTable();
            }
        }

        function updateManualInputsForNewCount() {
            const newInputs = {};
            getDistSuppliers().forEach(key => {
                newInputs[key] = manualInputs[key] || "";
            });
            manualInputs = newInputs;
        }

        function updateManualInput(key, value) {
            const cleanValue = sanitizeNumber(value);
            manualInputs[key] = cleanValue;
            const inputElement = document.getElementById(`manual-${key}`);
            if (inputElement) {
                const cursorPos = inputElement.selectionStart;
                const formattedValue = formatNumber(cleanValue);
                inputElement.value = formattedValue;
                const newCursorPos = Math.min(cursorPos + (formattedValue.length - value.length), formattedValue.length);
                inputElement.setSelectionRange(newCursorPos, newCursorPos);
            }
            updateDistributionResults();
        }

        function renderDistributionTable() {
            const tbody = document.getElementById('distribution-table');
            const distSuppliers = getDistSuppliers();

            tbody.innerHTML = '';

            distSuppliers.forEach((key, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="p-3">ê³µê¸‰ì ${key}</td>
                    <td class="p-3">
                        <input type="text"
                               value="${formatNumber(manualInputs[key] || "")}"
                               oninput="updateManualInput('${key}', this.value)"
                               id="manual-${key}"
                               class="w-full border rounded-lg px-2 py-1">
                    </td>
                    <td class="p-3">${getFinalAmount(key).toLocaleString()}ì›</td>
                `;
                tbody.appendChild(row);
            });

            updateDistributionSummary();
        }

        function updateDistributionResults() {
            const distSuppliers = getDistSuppliers();
            distSuppliers.forEach((key, index) => {
                const rows = document.querySelectorAll('#distribution-table tr');
                if (rows[index]) {
                    const cells = rows[index].querySelectorAll('td');
                    if (cells[2]) {
                        cells[2].textContent = `${getFinalAmount(key).toLocaleString()}ì›`;
                    }
                }
            });
            updateDistributionSummary();
        }

        function updateDistributionSummary() {
            const totalLoan = parseNumber(document.getElementById('manualTotal').value);
            const distributed = getTotalDistributed();
            const difference = distributed - totalLoan;

            document.getElementById('distribution-summary').textContent =
                `í•©ê³„: ${distributed.toLocaleString()}ì› / ì˜¤ì°¨: ${difference.toLocaleString()}ì›`;
        }

        function resetManualInputs() {
            manualInputs = {};
            getDistSuppliers().forEach(key => {
                manualInputs[key] = "";
            });
            document.getElementById('manualTotal').value = "";
            renderDistributionTable();
        }

        function calculateVAT() {
            const input = document.getElementById('vatInput');
            const rawValue = input.value;
            input.value = formatNumber(rawValue);

            const value = parseNumber(rawValue);
            if (value > 0) {
                const vat = Math.floor(value / 11);
                const supply = value - vat;
                document.getElementById('vatOutput').value = `${vat.toLocaleString()}ì›`;
                document.getElementById('supplyAmount').value = `${supply.toLocaleString()}ì›`;
            } else {
                document.getElementById('vatOutput').value = "";
                document.getElementById('supplyAmount').value = "";
            }
        }

        function resetVAT() {
            document.getElementById('vatInput').value = "";
            document.getElementById('vatOutput').value = "";
            document.getElementById('supplyAmount').value = "";
        }

        function calculateInterest() {
            const loanInput = document.getElementById('loanAmount');
            const rawLoanValue = loanInput.value;
            loanInput.value = formatNumber(rawLoanValue);

            const rateInput = document.getElementById('annualRate2');
            rateInput.value = sanitizeDecimal(rateInput.value);

            const yearsInput = document.getElementById('years');
            yearsInput.value = yearsInput.value.replace(/[^0-9]/g, "");

            const principalInManwon = parseNumber(rawLoanValue);
            const principal = principalInManwon * 10000;
            const rateValue = parseFloat(rateInput.value) || 0;
            const rate = rateValue / 100;
            const y = parseInt(yearsInput.value, 10) || 1;

            if (principal > 0 && rate > 0 && y > 0) {
                const year = Math.floor(principal * rate * y);
                const month = Math.floor(year / 12);
                const day = Math.floor(year / 365);

                document.getElementById('yearlyInterest').value = `${year.toLocaleString()}ì›`;
                document.getElementById('monthlyInterest').value = `${month.toLocaleString()}ì›`;
                document.getElementById('dailyInterest').value = `${day.toLocaleString()}ì›`;
            } else {
                document.getElementById('yearlyInterest').value = "";
                document.getElementById('monthlyInterest').value = "";
                document.getElementById('dailyInterest').value = "";
            }

            document.getElementById('yearlyLabel').textContent = `${y}ë…„ ì´ì`;
            updateDailyRateDisplay(rateValue);
        }

        function updateDailyRateDisplay(rateValue) {
            const displayDiv = document.getElementById('dailyRateDisplay');
            if (rateValue > 0) {
                const monthlyRate = (rateValue / 12).toFixed(3);
                const dailyRate = (rateValue / 365).toFixed(4);
                displayDiv.innerHTML = `ì—°ì´ìœ¨ <b>${rateValue}%</b>ëŠ” ì›” ì´ììœ¨ <b>${monthlyRate}%</b>, ì¼ ì´ììœ¨ <b>${dailyRate}%</b>ì…ë‹ˆë‹¤.`;
                displayDiv.classList.remove('hidden');
            } else {
                displayDiv.classList.add('hidden');
            }
        }

        function resetInterest() {
            document.getElementById('loanAmount').value = "";
            document.getElementById('annualRate2').value = "";
            document.getElementById('years').value = "1";
            document.getElementById('yearlyInterest').value = "";
            document.getElementById('monthlyInterest').value = "";
            document.getElementById('dailyInterest').value = "";
            document.getElementById('dailyRateDisplay').classList.add('hidden');
            document.getElementById('yearlyLabel').textContent = "1ë…„ ì´ì";
        }

        function calculateDateAddition() {
            const dateStart = document.getElementById('dateStart').value;
            const daysToAdd = parseInt(document.getElementById('daysToAdd').value) || 0;

            if (!dateStart) {
                document.getElementById('dateResult').value = '';
                return;
            }

            const date = new Date(dateStart);
            date.setDate(date.getDate() + daysToAdd);

            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const resultDate = `${year}-${month}-${day}`;

            document.getElementById('dateResult').value = resultDate;
        }

        function resetDateAddition() {
            document.getElementById('dateStart').value = '';
            document.getElementById('daysToAdd').value = '';
            document.getElementById('dateResult').value = '';
        }

        function calculateDateDifference() {
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;

            if (!dateFrom || !dateTo) {
                document.getElementById('dateDifference').value = '';
                return;
            }

            const from = new Date(dateFrom);
            const to = new Date(dateTo);

            const timeDifference = Math.abs(to - from);
            const daysDifference = Math.ceil(timeDifference / (1000 * 60 * 60 * 24));

            document.getElementById('dateDifference').value = `${daysDifference}ì¼`;
        }

        function resetDateDifference() {
            document.getElementById('dateFrom').value = '';
            document.getElementById('dateTo').value = '';
            document.getElementById('dateDifference').value = '';
        }

        // ì´ˆê¸°í™”
        renderSuppliers();
        renderDistributionTable();
        resetLoanDisplay();
    </script>
</body>
</html>
