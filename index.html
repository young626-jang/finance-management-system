<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>통합 금융 가이드 및 계산기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .guide-container {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .guide-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2c3e50;
        }

        .guide-h1 {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .guide-subtitle {
            font-size: 13px;
            color: #7f8c8d;
        }

        .guide-section {
            margin-bottom: 25px;
        }

        .guide-h2 {
            font-size: 16px;
            font-weight: 700;
            background-color: #34495e;
            color: white;
            padding: 10px 15px;
            margin-bottom: 12px;
            border-radius: 4px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 12px;
            margin-bottom: 15px;
        }

        .info-item {
            background-color: #ecf0f1;
            padding: 12px;
            border-left: 4px solid #3498db;
            border-radius: 3px;
        }

        .info-label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 12px;
            display: block;
            margin-bottom: 4px;
        }

        .info-value {
            color: #27ae60;
            font-size: 13px;
            font-weight: 500;
        }

        .info-value.alert {
            color: #e74c3c;
        }

        .guide-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
            font-size: 13px;
        }

        .guide-table thead {
            background-color: #34495e;
            color: white;
        }

        .guide-table th {
            padding: 10px 8px;
            text-align: left;
            font-weight: 600;
            border: 1px solid #bdc3c7;
        }

        .guide-table td {
            padding: 9px 8px;
            border: 1px solid #ecf0f1;
        }

        .guide-table tbody tr:nth-child(odd) {
            background-color: #f9f9f9;
        }

        .note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px 12px;
            margin: 10px 0;
            border-radius: 3px;
            font-size: 12px;
            color: #856404;
        }

        .tag {
            display: inline-block;
            background-color: #e8f4f8;
            color: #2980b9;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-right: 5px;
        }
    </style>
</head>
<body class="bg-slate-50">
    <div class="max-w-7xl mx-auto">
        <!-- 상단 배너 섹션 -->
        <div class="p-4 md:p-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <!-- 노션 바로가기 배너 -->
                <a href="https://www.notion.so/1f2ebdf111b580cdbefbe40390c5428c?v=1f2ebdf111b581229457000c8a053910" target="_blank" rel="noopener noreferrer" class="block">
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow h-40 flex flex-col justify-between text-white">
                        <div>
                            <div class="text-sm font-semibold opacity-90 mb-2">📚 문서</div>
                            <h3 class="text-2xl font-bold">노션 바로가기</h3>
                        </div>
                        <div class="text-sm opacity-90">바로가기 →</div>
                    </div>
                </a>

                <!-- LTV 계산기 배너 -->
                <a href="https://ltv-flask-young.onrender.com/" target="_blank" rel="noopener noreferrer" class="block">
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow h-40 flex flex-col justify-between text-white">
                        <div>
                            <div class="text-sm font-semibold opacity-90 mb-2">금융 도구</div>
                            <h3 class="text-2xl font-bold">LTV계산기</h3>
                        </div>
                        <div class="text-sm opacity-90">바로가기 →</div>
                    </div>
                </a>

                <!-- 론프라전산 배너 -->
                <a href="https://app.loanfra.com/self_screening" target="_blank" rel="noopener noreferrer" class="block">
                    <div class="bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow h-40 flex flex-col justify-between text-white">
                        <div>
                            <div class="text-sm font-semibold opacity-90 mb-2">전산 시스템</div>
                            <h3 class="text-2xl font-bold">론프라전산</h3>
                        </div>
                        <div class="text-sm opacity-90">바로가기 →</div>
                    </div>
                </a>
            </div>

            <!-- 빠른 이동 카드 -->
            <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 mb-6">
                <h4 class="font-semibold text-slate-800 mb-4 text-lg">📑 빠른 이동</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button onclick="switchTab('calculator'); return false;" class="px-6 py-3 bg-blue-50 text-blue-600 hover:bg-blue-100 font-medium rounded-xl transition border border-blue-200 cursor-pointer">다기능 계산기</button>
                    <button onclick="switchTab('guide1'); return false;" class="px-6 py-3 bg-blue-50 text-blue-600 hover:bg-blue-100 font-medium rounded-xl transition border border-blue-200 cursor-pointer">희망담보 가이드</button>
                    <button onclick="switchTab('guide2'); return false;" class="px-6 py-3 bg-blue-50 text-blue-600 hover:bg-blue-100 font-medium rounded-xl transition border border-blue-200 cursor-pointer">개인정보 관리</button>
                </div>
            </div>
        </div>

        <!-- 메인 콘텐츠 -->
        <div class="p-4 md:p-6">
            <!-- 탭 1: 다기능 계산기 -->
            <div id="calculator" class="tab-content active">
                <div class="bg-white rounded-lg p-6 md:p-8">
                    <h1 class="text-2xl md:text-3xl font-bold mb-6">통합 계산기</h1>

                    <!-- 부가세 계산기 -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">부가세 계산기</h2>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">부가세 포함 금액 입력</label>
                            <input type="text" id="vatInput" oninput="calculateVAT()" class="w-full border rounded-xl px-3 py-2" />
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">공급가액</label>
                            <input type="text" id="supplyAmount" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">부가세</label>
                            <input type="text" id="vatOutput" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>
                        <button onclick="resetVAT()" class="px-4 py-2 rounded-xl bg-blue-500 text-white hover:bg-blue-600 transition">부가세 초기화</button>
                    </div>

                    <!-- 날짜 계산기 -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">날짜 계산기</h2>

                        <!-- 날짜에 일수 더하기 -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3 text-slate-700">1. 날짜에 일수 더하기</h3>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">시작 날짜</label>
                                <input type="date" id="dateStart" oninput="calculateDateAddition()" class="w-full border rounded-xl px-3 py-2" />
                            </div>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">더할 일수 (일)</label>
                                <input type="number" id="daysToAdd" oninput="calculateDateAddition()" class="w-full border rounded-xl px-3 py-2" placeholder="예: 10" />
                            </div>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">결과 날짜</label>
                                <input type="text" id="dateResult" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                            </div>
                            <button onclick="resetDateAddition()" class="px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition">초기화</button>
                        </div>

                        <hr class="my-6 border-slate-200" />

                        <!-- 두 날짜 사이 일수 계산 -->
                        <div>
                            <h3 class="text-lg font-semibold mb-3 text-slate-700">2. 두 날짜 사이의 일수 계산</h3>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">시작 날짜</label>
                                <input type="date" id="dateFrom" oninput="calculateDateDifference()" class="w-full border rounded-xl px-3 py-2" />
                            </div>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">종료 날짜</label>
                                <input type="date" id="dateTo" oninput="calculateDateDifference()" class="w-full border rounded-xl px-3 py-2" />
                            </div>
                            <div class="mb-4">
                                <label class="block mb-2 font-semibold">일수</label>
                                <input type="text" id="dateDifference" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                            </div>
                            <button onclick="resetDateDifference()" class="px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition">초기화</button>
                        </div>
                    </div>

                    <!-- 공급자별 자동금액 합산기 -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">공급자별 자동금액 합산기</h2>
                        <button onclick="addSupplier()" class="px-4 py-2 rounded-xl bg-blue-500 text-white hover:bg-blue-600 transition mb-4">공급자 추가 +</button>
                        <div id="suppliers-container"></div>
                    </div>

                    <!-- 공급자 분배금 계산기 -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">공급자 분배금 계산기</h2>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">이 분배 금액</label>
                            <input type="text" id="manualTotal" oninput="updateDistribution()" class="w-full border rounded-xl px-3 py-2" />
                        </div>
                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">공급자 수</label>
                            <div class="flex items-center gap-2">
                                <button onclick="changeSupplierCount(-1)" class="w-10 h-10 bg-slate-200 rounded-lg font-bold hover:bg-slate-300">−</button>
                                <input type="number" id="supplierCount" value="2" oninput="updateSupplierCount()" class="w-16 border rounded-xl px-2 py-1 text-center" />
                                <button onclick="changeSupplierCount(1)" class="w-10 h-10 bg-slate-200 rounded-lg font-bold hover:bg-slate-300">+</button>
                            </div>
                        </div>
                        <table class="w-full mb-4 border-collapse">
                            <thead class="bg-slate-100">
                                <tr>
                                    <th class="p-3 text-left">공급자</th>
                                    <th class="p-3 text-left">수기 입력 금액</th>
                                    <th class="p-3 text-left">자동 계산 금액 원</th>
                                </tr>
                            </thead>
                            <tbody id="distribution-table"></tbody>
                        </table>
                        <div id="distribution-summary" class="text-sm text-slate-600 mb-4"></div>
                        <button onclick="resetManualInputs()" class="px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition">수기입력 초기화</button>
                    </div>

                    <!-- 원금 퍼센트·만기일시 대출 계산기 -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm mb-6 border border-slate-200">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-bold pb-2 border-b flex-1">원금 퍼센트·만기일시 대출 계산기</h2>
                            <button onclick="resetLoanCalc()" class="px-4 py-2 rounded-xl bg-red-500 text-white hover:bg-red-600 transition ml-4">초기화</button>
                        </div>
                        <p class="text-sm md:text-base text-slate-600 mb-6">
                            대출 원금의 <b>X%</b>만 기간 동안 매월 분할 상환하고, 나머지 <b>(1−X%)</b>는 만기일에 일시 상환하는 구조를 계산합니다.
                        </p>

                        <div class="grid md:grid-cols-2 gap-4 mb-6">
                            <label class="flex flex-col gap-2 bg-white rounded-2xl p-4 shadow-sm border">
                                <span class="text-sm text-slate-600">대출금 (원)</span>
                                <input type="text" id="loan" class="border rounded-xl px-3 py-2" oninput="handleLoanInput(event)" placeholder="예: 300,000,000" />
                            </label>
                            <label class="flex flex-col gap-2 bg-white rounded-2xl p-4 shadow-sm border">
                                <span class="text-sm text-slate-600">연이율 (%)</span>
                                <input type="number" id="annualRate" class="border rounded-xl px-3 py-2" oninput="calculateLoan()" min="0" step="0.01" placeholder="예: 4.8" />
                            </label>
                            <label class="flex flex-col gap-2 bg-white rounded-2xl p-4 shadow-sm border">
                                <span class="text-sm text-slate-600">원금 분할 비율 (X%)</span>
                                <input type="number" id="principalPct" class="border rounded-xl px-3 py-2" oninput="calculateLoan()" min="0" max="100" step="0.1" placeholder="예: 7" />
                            </label>
                            <label class="flex flex-col gap-2 bg-white rounded-2xl p-4 shadow-sm border">
                                <span class="text-sm text-slate-600">기간 (개월)</span>
                                <input type="number" id="months" class="border rounded-xl px-3 py-2" oninput="calculateLoan()" min="1" step="1" placeholder="예: 60" />
                                <span id="monthsError" class="text-xs text-red-600 hidden">기간(개월)은 1 이상이어야 합니다.</span>
                            </label>
                        </div>

                        <div class="grid md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-1">매월 원금</div>
                                <div id="monthlyPrincipal" class="text-xl font-semibold text-slate-400">- 원</div>
                            </div>
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-1">첫 달 납입액</div>
                                <div id="firstMonthPayment" class="text-xl font-semibold text-slate-400">- 원</div>
                                <div id="firstMonthBreakdown" class="text-xs text-slate-500">(원금 + 이자)</div>
                            </div>
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-1">만기월 납입액</div>
                                <div id="finalMonthPayment" class="text-xl font-semibold text-slate-400">- 원</div>
                                <div id="finalMonthBreakdown" class="text-xs text-slate-500">(원금 + 이자)</div>
                            </div>
                        </div>

                        <div class="grid md:grid-cols-2 gap-4 mb-6">
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-2">구성</div>
                                <ul class="text-sm leading-7 list-disc pl-5">
                                    <li>기간 중 분할 상환 원금 합계: <b id="principalPortion" class="text-slate-400">- 원</b></li>
                                    <li>매월 고정 원금: <b id="monthlyPrincipalFixed" class="text-slate-400">- 원</b></li>
                                    <li>만기 일시상환 원금(잔액): <b id="finalBalloonPrincipal" class="text-slate-400">- 원</b></li>
                                </ul>
                            </div>
                            <div class="bg-white rounded-2xl p-4 shadow-sm border border-slate-200">
                                <div class="text-sm text-slate-600 mb-2">요약</div>
                                <ul class="text-sm leading-7 list-disc pl-5">
                                    <li>월 이자율: <span id="monthlyRate" class="text-slate-400">-%</span></li>
                                    <li>총 이자(추정): <b id="totalInterest" class="text-slate-400">- 원</b></li>
                                    <li>총 납부액(원금+이자): <b id="totalPaid" class="text-slate-400">- 원</b></li>
                                </ul>
                            </div>
                        </div>

                        <button onclick="toggleLoanSchedule()" class="px-4 py-2 rounded-xl bg-slate-900 text-white hover:opacity-90 transition">상환 스케줄 보기</button>

                        <div id="scheduleContainer" class="hidden overflow-x-auto mt-4 bg-white rounded-2xl shadow-sm border border-slate-200">
                            <table class="min-w-full text-sm">
                                <thead class="bg-slate-100">
                                    <tr>
                                        <th class="p-3 text-left">월</th>
                                        <th class="p-3 text-right">월초 잔액</th>
                                        <th class="p-3 text-right">원금</th>
                                        <th class="p-3 text-right">이자</th>
                                        <th class="p-3 text-right">납입액</th>
                                        <th class="p-3 text-right">월말 잔액</th>
                                    </tr>
                                </thead>
                                <tbody id="scheduleBody"></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 이자 계산기 -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200">
                        <h2 class="text-xl font-bold mb-4 pb-2 border-b">이자 계산기</h2>

                        <div id="dailyRateDisplay" class="hidden mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg text-sm text-blue-800"></div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">대출금액 (만원)</label>
                            <input type="text" id="loanAmount" oninput="calculateInterest()" class="w-full border rounded-xl px-3 py-2" />
                        </div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">연이율 (%)</label>
                            <input type="text" id="annualRate2" oninput="calculateInterest()" class="w-full border rounded-xl px-3 py-2" />
                        </div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">이자 계산 연 수 (년)</label>
                            <input type="number" id="years" value="1" oninput="calculateInterest()" class="w-full border rounded-xl px-3 py-2" />
                        </div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">하루 이자</label>
                            <input type="text" id="dailyInterest" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>

                        <div class="mb-4">
                            <label class="block mb-2 font-semibold">한달 이자</label>
                            <input type="text" id="monthlyInterest" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>

                        <div class="mb-4">
                            <label id="yearlyLabel" class="block mb-2 font-semibold">1년 이자</label>
                            <input type="text" id="yearlyInterest" readonly class="w-full border rounded-xl px-3 py-2 bg-slate-100" />
                        </div>

                        <button onclick="resetInterest()" class="px-4 py-2 rounded-xl bg-blue-500 text-white hover:bg-blue-600 transition">이자 초기화</button>
                    </div>
                </div>
            </div>

            <!-- 탭 2: 희망담보 가이드 -->
            <div id="guide1" class="tab-content">
                <div class="guide-container max-w-4xl mx-auto bg-white rounded-lg p-6 md:p-8">
                    <div class="guide-header">
                        <h1 class="guide-h1">희망담보</h1>
                        <p class="guide-subtitle">대출 상품 가이드라인 (최종 업데이트)</p>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">📋 기본 상품 정보</h2>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">상품명</span>
                                <span class="info-value">희망담보</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">대출기간</span>
                                <span class="info-value">2년</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">대출대상</span>
                                <span class="info-value">아파트 및 주상복합아파트</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">취급 가능 지역</span>
                                <span class="info-value">서울, 경기도, 인천</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">신용점수</span>
                                <span class="info-value">커트라인 없음<span class="tag">단, 연체자 불가</span></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">소득 심사</span>
                                <span class="info-value">본인/배우자/기타 소득 중요</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">상환방식</span>
                                <span class="info-value">만기일시상환</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">중도상환수수료</span>
                                <span class="info-value">3%</span>
                            </div>
                        </div>

                        <h3 style="font-size: 13px; color: #2c3e50; margin: 12px 0 8px; font-weight: 600;">금리</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">대출금리</span>
                                <span class="info-value">10.9% (예외) / 11.9 ~ 13.9%</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">연체금리</span>
                                <span class="info-value alert">대출금리 + 3.0%</span>
                            </div>
                        </div>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">📊 시세 적용 기준</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th style="width: 30%;">구분</th>
                                    <th>적용 기준</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>하한가</strong></td>
                                    <td>1~2인층</td>
                                </tr>
                                <tr>
                                    <td><strong>일반가</strong></td>
                                    <td>그 외인층</td>
                                </tr>
                                <tr>
                                    <td><strong>시세 출처</strong></td>
                                    <td>KB시세 우선 적용, 부동산테크 적용</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">💰 LTV 및 금리</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th style="width: 30%;">구분</th>
                                    <th style="width: 35%;">LTV 범위</th>
                                    <th>인층별 적용</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>선순위</strong></td>
                                    <td>80%</td>
                                    <td>전체</td>
                                </tr>
                                <tr>
                                    <td><strong>후순위</strong></td>
                                    <td>80%</td>
                                    <td>전체</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">👤 사업자 자격 조건</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th style="width: 40%;">조건</th>
                                    <th>필수여부</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>즉발사업자 가능</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td><strong>폐업이 아닌 개업상태</strong></td>
                                    <td><span style="color: #e74c3c; font-weight: 600;">필수</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">🏠 인정 부동산 조건</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th>조건</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>소유권이전 3개월 이후 부동산</td>
                                </tr>
                                <tr>
                                    <td>준공후 45년 미만 및 시세 3억 초과 부동산</td>
                                </tr>
                                <tr>
                                    <td>이 세대수 100세대 이상 부동산</td>
                                </tr>
                                <tr>
                                    <td>후순위 취급시 선순위 채권자: <strong>금융기관에 한함</strong></td>
                                </tr>
                                <tr>
                                    <td>물상보증인(배우자 및 직계존비속) 가능</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="note">
                            ※ 금융기관: 금융소비자 보호에 관한 법률 제2조 제6호 기준 내지 마련 적용
                        </div>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">❌ 취급 불가</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th>취급 불가 사항</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>부동산업/매매업, 사치향락 등 불건전업종 (도박, 매춘, 유흥업소 등)</td>
                                </tr>
                                <tr>
                                    <td><strong>연체 및 채무불이행 등의 고객</strong></td>
                                </tr>
                                <tr>
                                    <td>차주 및 담보채권자의 법인 또는 외국인 경우</td>
                                </tr>
                                <tr>
                                    <td>소유권에 대한 권리침해의 소지가 있는 경우</td>
                                </tr>
                                <tr>
                                    <td>세대 전입이 없는 경우</td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="note">
                            ※ 소득 없어도 가능하나, 심사시 부결될 수 있습니다.
                        </div>
                    </div>
                </div>
            </div>

            <!-- 탭 3: 개인정보 관리 -->
            <div id="guide2" class="tab-content">
                <div class="guide-container max-w-4xl mx-auto bg-white rounded-lg p-6 md:p-8">
                    <div class="guide-header">
                        <h1 class="guide-h1">개인정보 보유·파기 관리 가이드</h1>
                        <p class="guide-subtitle">금융 회사 내부 교육 및 실무 매뉴얼</p>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">1. 개인정보 보유 기준</h2>

                        <div style="background-color: #ecf0f1; border-left: 4px solid #27ae60; padding: 20px; margin: 30px 0; border-radius: 4px;">
                            <div style="font-size: 18px; color: #27ae60; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="margin-right: 10px;">📋</span> 계약이 체결된 고객
                            </div>
                            <div class="info-grid">
                                <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                    <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">보유 기간</div>
                                    <div style="color: #444; line-height: 1.6;">거래 종료 후 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px; font-weight: 600;">5년</span></div>
                                </div>
                                <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                    <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">근거 법령</div>
                                    <div style="color: #444; line-height: 1.6;">「신용정보의 이용 및 보호에 관한 법률」(신용정보법) 제20조의2 제2항 제1호</div>
                                </div>
                            </div>
                            <div class="note" style="margin-top: 15px;">
                                <strong>법 내용:</strong> 신용정보제공·이용자는 상거래관계가 종료된 날부터 최장 5년까지 개인신용정보를 보유·이용할 수 있습니다.
                            </div>
                            <div style="background-color: #d5f4e6; border-left: 4px solid #27ae60; padding: 15px; margin: 15px 0; border-radius: 4px;">
                                <strong style="color: #229954;">해설:</strong> 대출 계약이 정상적으로 종료(원리금 전액 상환 등)된 경우, 해당 시점부터 5년 동안 정보를 보관하는 것이 맞습니다. 이는 법이 허용하는 최대 기간이며, 금융 분쟁이나 사후 관리 등을 위한 일반적인 금융권의 기준입니다.
                            </div>
                        </div>

                        <div style="background-color: #ecf0f1; border-left: 4px solid #27ae60; padding: 20px; margin: 30px 0; border-radius: 4px;">
                            <div style="font-size: 18px; color: #27ae60; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="margin-right: 10px;">📋</span> 계약 미체결 고객
                            </div>
                            <div class="info-grid">
                                <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                    <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">보유 기간</div>
                                    <div style="color: #444; line-height: 1.6;">심사 종료일로부터 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px; font-weight: 600;">3년 이내 파기</span></div>
                                </div>
                                <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                    <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">근거 법령</div>
                                    <div style="color: #444; line-height: 1.6;">「신용정보법 시행령」 제17조의2 제4항</div>
                                </div>
                            </div>
                            <div class="note" style="margin-top: 15px;">
                                <strong>법 내용:</strong> 신용정보회사 등은 개인신용정보의 조회 동의를 받은 날부터 3년이 지나면 해당 동의의 효력이 소멸한 것으로 보고 관련 정보를 삭제해야 합니다.
                            </div>
                            <div style="background-color: #d5f4e6; border-left: 4px solid #27ae60; padding: 15px; margin: 15px 0; border-radius: 4px;">
                                <strong style="color: #229954;">해설:</strong> 고객이 대출을 신청하여 신용정보 조회 등에 동의했지만, 심사 결과 거절되었거나 고객이 신청을 철회한 경우에 해당합니다. 이 경우, 동의의 효력이 유지되는 기간을 최대 3년으로 보기 때문에 심사 종료 후 3년 이내에 파기하는 것이 정확한 기준입니다.
                            </div>
                        </div>

                        <div style="background-color: #ecf0f1; border-left: 4px solid #27ae60; padding: 20px; margin: 30px 0; border-radius: 4px;">
                            <div style="font-size: 18px; color: #27ae60; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="margin-right: 10px;">📋</span> 민원·분쟁 관련 기록
                            </div>
                            <div class="info-grid">
                                <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                    <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">보유 기간</div>
                                    <div style="color: #444; line-height: 1.6;">처리 완료 후 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px; font-weight: 600;">5년 보관</span></div>
                                </div>
                                <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                    <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">근거 법령</div>
                                    <div style="color: #444; line-height: 1.6;">「전자상거래 등에서의 소비자보호에 관한 법률」 제6조 및 동법 시행령 제6조</div>
                                </div>
                            </div>
                            <div class="note" style="margin-top: 15px;">
                                <strong>법 내용:</strong> 소비자의 불만 또는 분쟁처리에 관한 기록은 3년간 보존하도록 규정하고 있습니다.
                            </div>
                            <div style="background-color: #d5f4e6; border-left: 4px solid #27ae60; padding: 15px; margin: 15px 0; border-radius: 4px;">
                                <strong style="color: #229954;">해설:</strong> 비록 전자상거래법에서는 3년으로 규정하고 있지만, 금융 민원이나 분쟁은 그 복잡성과 중요도를 감안하여 「신용정보법」의 최대 보관 기간인 5년을 적용하는 것이 더욱 안전하고 일반적인 실무 기준입니다.
                            </div>
                        </div>

                        <div style="background-color: #ecf0f1; border-left: 4px solid #27ae60; padding: 20px; margin: 30px 0; border-radius: 4px;">
                            <div style="font-size: 18px; color: #27ae60; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center;">
                                <span style="margin-right: 10px;">📋</span> 마케팅 목적 데이터
                            </div>
                            <div class="info-grid">
                                <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                    <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">보유 기간</div>
                                    <div style="color: #444; line-height: 1.6;">동의일로부터 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px; font-weight: 600;">2년 또는 철회 시 즉시 파기</span></div>
                                </div>
                                <div style="display: grid; grid-template-columns: 120px 1fr; gap: 15px; padding: 12px; background-color: white; border-radius: 4px;">
                                    <div style="font-weight: 600; color: #2c3e50; min-width: 120px;">근거 법령</div>
                                    <div style="color: #444; line-height: 1.6;">「개인정보 보호법」 제21조 및 「신용정보법」 제37조</div>
                                </div>
                            </div>
                            <div class="note" style="margin-top: 15px;">
                                <strong>법 내용:</strong> 개인정보의 보유기간이 경과했거나 처리 목적이 달성되었을 때에는 지체 없이 파기해야 합니다. 마케팅 활용 동의는 고객이 언제든지 철회할 수 있으며, 철회 시 즉시 정보 처리를 중지하고 파기해야 합니다.
                            </div>
                            <div style="background-color: #d5f4e6; border-left: 4px solid #27ae60; padding: 15px; margin: 15px 0; border-radius: 4px;">
                                <strong style="color: #229954;">해설:</strong> 마케팅 동의의 유효기간을 법에서 명확히 "O년"으로 정하고 있지는 않지만, 정보통신망법의 과거 규정 등을 준용하여 실무적으로 2년마다 재동의를 받는 것이 일반적인 기준으로 자리 잡았습니다.
                            </div>
                        </div>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">2. 핵심 원칙: 분리 보관과 정기적 파기</h2>

                        <div style="background-color: #f8f9fa; border-left: 4px solid #3498db; padding: 20px; margin: 25px 0; border-radius: 4px;">
                            <h3 style="font-size: 16px; color: #34495e; margin-top: 0; margin-bottom: 15px; font-weight: 600; display: flex; align-items: center;">
                                <span style="display: inline-block; width: 6px; height: 6px; background-color: #3498db; border-radius: 50%; margin-right: 12px; flex-shrink: 0;"></span>
                                데이터 상태 관리
                            </h3>
                            <p>모든 고객 데이터는 명확한 상태 값으로 관리해야 합니다. 엑셀로 관리하든, 별도 프로그램을 사용하든 이 구분이 모든 처리의 시작입니다.</p>
                            <ul style="margin-left: 20px; margin-top: 10px; margin-bottom: 15px;">
                                <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[심사중]</span> - 현재 대출 심사 진행 중</li>
                                <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[계약고객]</span> - 계약 체결 완료</li>
                                <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[거래종료]</span> - 상환 완료 또는 계약 종료</li>
                                <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[심사탈락]</span> / <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[신청철회]</span> - 심사 불통과 또는 고객 신청 철회</li>
                                <li style="margin-bottom: 8px; color: #555;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[분쟁진행중]</span> - 민원 또는 분쟁 진행 중</li>
                            </ul>
                        </div>

                        <div style="background-color: #f8f9fa; border-left: 4px solid #3498db; padding: 20px; margin: 25px 0; border-radius: 4px;">
                            <h3 style="font-size: 16px; color: #34495e; margin-top: 0; margin-bottom: 15px; font-weight: 600; display: flex; align-items: center;">
                                <span style="display: inline-block; width: 6px; height: 6px; background-color: #3498db; border-radius: 50%; margin-right: 12px; flex-shrink: 0;"></span>
                                물리적/논리적 분리
                            </h3>
                            <p>보관 기간이 만료된 데이터나 파기 대상 데이터는 활성 고객 데이터와 완전히 다른 공간으로 옮겨 접근을 차단해야 합니다.</p>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li style="margin-bottom: 8px; color: #555;">별도 폴더 또는 별도 DB 테이블 구성</li>
                                <li style="margin-bottom: 8px; color: #555;">파기 예정 데이터는 일반 직원의 접근 제한</li>
                                <li style="margin-bottom: 8px; color: #555;">마케팅 발송 시스템에서 자동 제외</li>
                            </ul>
                        </div>

                        <div style="background-color: #f8f9fa; border-left: 4px solid #3498db; padding: 20px; margin: 25px 0; border-radius: 4px;">
                            <h3 style="font-size: 16px; color: #34495e; margin-top: 0; margin-bottom: 15px; font-weight: 600; display: flex; align-items: center;">
                                <span style="display: inline-block; width: 6px; height: 6px; background-color: #3498db; border-radius: 50%; margin-right: 12px; flex-shrink: 0;"></span>
                                파기 기록 관리
                            </h3>
                            <p>언제, 누가, 어떤 정보를 파기했는지 반드시 기록하여 증빙 자료를 남겨야 합니다.</p>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li style="margin-bottom: 8px; color: #555;">「개인정보 파기 관리대장」에 모든 내용 기록</li>
                                <li style="margin-bottom: 8px; color: #555;">감독기관의 자료 요청 시 중요한 증빙 자료</li>
                            </ul>
                        </div>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">3. 단계별 실무 처리 방법</h2>

                        <div style="background-color: white; border: 1px solid #ecf0f1; padding: 20px; margin: 20px 0; border-radius: 4px;">
                            <div style="display: flex; align-items: flex-start; margin-bottom: 15px;">
                                <div style="display: inline-block; background-color: #3498db; color: white; width: 35px; height: 35px; border-radius: 50%; text-align: center; line-height: 35px; font-weight: 700; margin-right: 12px; flex-shrink: 0;">1</div>
                                <div style="font-size: 16px; font-weight: 600; color: #2c3e50;">대출 신청 및 심사</div>
                            </div>
                            <div style="margin-left: 47px; color: #555;">
                                <strong>처리 방법:</strong>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li style="margin-bottom: 8px;">고객으로부터 '개인신용정보 수집·이용·조회 동의서' 획득</li>
                                    <li style="margin-bottom: 8px;">고객 정보를 시스템(또는 관리 파일)에 입력하고 상태를 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[심사중]</span>으로 설정</li>
                                    <li style="margin-bottom: 8px;">종이 서류(신청서, 신분증 사본 등)는 '심사중 서류함'에 별도 보관</li>
                                </ul>
                            </div>
                        </div>

                        <div style="background-color: white; border: 1px solid #ecf0f1; padding: 20px; margin: 20px 0; border-radius: 4px;">
                            <div style="display: flex; align-items: flex-start; margin-bottom: 15px;">
                                <div style="display: inline-block; background-color: #3498db; color: white; width: 35px; height: 35px; border-radius: 50%; text-align: center; line-height: 35px; font-weight: 700; margin-right: 12px; flex-shrink: 0;">2</div>
                                <div style="font-size: 16px; font-weight: 600; color: #2c3e50;">심사 결과에 따른 분리 처리 (가장 중요)</div>
                            </div>
                            <div style="margin-left: 47px; color: #555;">
                                <p><strong>심사 완료 직후, 결과에 따라 고객 데이터를 즉시 분리해야 합니다.</strong></p>

                                <h3 style="margin-top: 20px; font-size: 15px; font-weight: 600; color: #2c3e50;">A. 계약 체결 시</h3>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li style="margin-bottom: 8px;">고객 상태를 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[심사중]</span>에서 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[계약고객]</span>으로 변경</li>
                                    <li style="margin-bottom: 8px;">종이 서류는 '심사중 서류함'에서 '계약 고객 서류함'으로 옮겨 계약서와 함께 보관</li>
                                    <li style="margin-bottom: 8px;">파기 시점: 아직 발생하지 않음. '거래 종료일'이 기준</li>
                                </ul>

                                <h3 style="margin-top: 20px; font-size: 15px; font-weight: 600; color: #2c3e50;">B. 계약 미체결 시 (거절, 고객 취소 등)</h3>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li style="margin-bottom: 8px;">고객 상태를 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[심사중]</span>에서 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[심사탈락]</span> 또는 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[신청철회]</span>로 변경</li>
                                    <li style="margin-bottom: 8px;">시스템(파일)에서 해당 고객 정보를 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">'3년 후 파기 대상 목록'</span>으로 이동시키거나, 파기 예정일을 기재</li>
                                    <li style="margin-bottom: 8px;">종이 서류는 즉시 파기하거나, '즉시 파기 대상 서류함'에 넣어 월별/분기별 파기 절차 진행</li>
                                </ul>
                            </div>
                        </div>

                        <div style="background-color: white; border: 1px solid #ecf0f1; padding: 20px; margin: 20px 0; border-radius: 4px;">
                            <div style="display: flex; align-items: flex-start; margin-bottom: 15px;">
                                <div style="display: inline-block; background-color: #3498db; color: white; width: 35px; height: 35px; border-radius: 50%; text-align: center; line-height: 35px; font-weight: 700; margin-right: 12px; flex-shrink: 0;">3</div>
                                <div style="font-size: 16px; font-weight: 600; color: #2c3e50;">계약 종료 처리</div>
                            </div>
                            <div style="margin-left: 47px; color: #555;">
                                <strong>처리 방법:</strong>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li style="margin-bottom: 8px;">고객의 대출 상환이 완료되면, 고객 상태를 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[계약고객]</span>에서 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[거래종료]</span>로 변경</li>
                                    <li style="margin-bottom: 8px;">시스템(파일)에서 해당 고객 정보를 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">'5년 후 파기 대상 목록'</span>으로 이동시키거나, 파기 예정일을 기재</li>
                                    <li style="margin-bottom: 8px;">이 데이터는 민원/분쟁 대응을 위한 것이므로, 일반적인 마케팅이나 연락 대상에서 완전히 제외</li>
                                </ul>
                            </div>
                        </div>

                        <div style="background-color: white; border: 1px solid #ecf0f1; padding: 20px; margin: 20px 0; border-radius: 4px;">
                            <div style="display: flex; align-items: flex-start; margin-bottom: 15px;">
                                <div style="display: inline-block; background-color: #3498db; color: white; width: 35px; height: 35px; border-radius: 50%; text-align: center; line-height: 35px; font-weight: 700; margin-right: 12px; flex-shrink: 0;">4</div>
                                <div style="font-size: 16px; font-weight: 600; color: #2c3e50;">정기적인 파기 실행</div>
                            </div>
                            <div style="margin-left: 47px; color: #555;">
                                <p><strong>정기적으로 날짜를 정해 아래 업무를 수행하는 담당자를 지정해야 합니다.</strong> (예: 매월 말 또는 매 분기 초)</p>

                                <h3 style="margin-top: 15px; font-size: 15px; font-weight: 600; color: #2c3e50;">파기 대상 목록 확인</h3>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li style="margin-bottom: 8px;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[심사탈락]</span>, <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[신청철회]</span> 상태의 고객 중, 심사종료일이 3년을 초과한 고객 목록 추출</li>
                                    <li style="margin-bottom: 8px;"><span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[거래종료]</span> 상태의 고객 중, 거래종료일이 5년을 초과한 고객 목록 추출</li>
                                </ul>

                                <h3 style="margin-top: 15px; font-size: 15px; font-weight: 600; color: #2c3e50;">파기 실행</h3>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li style="margin-bottom: 8px;"><strong>디지털 파일:</strong> DB, 엑셀 등 복구할 수 없는 방법으로 영구 삭제 (예: DB에서 DELETE 실행, 파일 완전 삭제)</li>
                                    <li style="margin-bottom: 8px;"><strong>종이 서류:</strong> 문서 파쇄기(분쇄기)를 이용하여 파쇄</li>
                                </ul>

                                <h3 style="margin-top: 15px; font-size: 15px; font-weight: 600; color: #2c3e50;">파기 관리대장 작성</h3>
                                <p><strong>필수 기재 항목:</strong></p>
                                <ul style="margin-left: 20px; margin-top: 10px;">
                                    <li style="margin-bottom: 8px;">파기 일자</li>
                                    <li style="margin-bottom: 8px;">파기한 정보 항목 (예: 김○○ 고객의 대출 심사 서류 일체)</li>
                                    <li style="margin-bottom: 8px;">파기 방법 (예: 문서 파쇄, DB 레코드 삭제)</li>
                                    <li style="margin-bottom: 8px;">처리 담당자 확인(서명)</li>
                                </ul>
                                <p style="margin-top: 10px; color: #c0392b;">감독기관의 자료 요청 시 매우 중요한 증빙이 되므로 정확하게 기록해야 합니다.</p>
                            </div>
                        </div>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">4. 특별 케이스 처리 방법</h2>

                        <div style="background-color: #f8f9fa; border-left: 4px solid #3498db; padding: 20px; margin: 25px 0; border-radius: 4px;">
                            <h3 style="font-size: 16px; color: #34495e; margin-top: 0; margin-bottom: 15px; font-weight: 600; display: flex; align-items: center;">
                                <span style="display: inline-block; width: 6px; height: 6px; background-color: #3498db; border-radius: 50%; margin-right: 12px; flex-shrink: 0;"></span>
                                마케팅 동의 철회 요청 시
                            </h3>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li style="margin-bottom: 15px; color: #555;">고객이 마케팅 수신 거부 의사를 밝히는 즉시, 해당 고객 정보에서 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[마케팅동의]</span> 상태를 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[마케팅거부]</span>로 변경</li>
                                <li style="margin-bottom: 15px; color: #555;">마케팅 발송 목록에서 영구 제외</li>
                                <li style="margin-bottom: 15px; color: #555;">이는 <strong>'즉시 처리'</strong>가 원칙입니다.</li>
                            </ul>
                            <div style="background-color: #d5f4e6; border-left: 4px solid #27ae60; padding: 15px; margin: 15px 0; border-radius: 4px;">
                                <strong style="color: #229954;">추가 관리:</strong> 2년이 지난 마케팅 동의 고객에게는 재동의를 받는 절차를 수립하는 것이 안전합니다.
                            </div>
                        </div>

                        <div style="background-color: #f8f9fa; border-left: 4px solid #3498db; padding: 20px; margin: 25px 0; border-radius: 4px;">
                            <h3 style="font-size: 16px; color: #34495e; margin-top: 0; margin-bottom: 15px; font-weight: 600; display: flex; align-items: center;">
                                <span style="display: inline-block; width: 6px; height: 6px; background-color: #3498db; border-radius: 50%; margin-right: 12px; flex-shrink: 0;"></span>
                                민원 또는 분쟁 발생 시
                            </h3>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li style="margin-bottom: 8px; color: #555;">만약 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[거래종료]</span> 고객과 분쟁이 발생했다면, 해당 고객 상태를 <span style="background-color: #fff3cd; padding: 2px 6px; border-radius: 3px;">[분쟁진행중]</span>으로 변경</li>
                                <li style="margin-bottom: 8px; color: #555;">이 경우, 보관 기간은 거래종료일 기준이 아닌 <strong>'분쟁 해결이 완료된 시점'</strong>으로부터 5년으로 연장하여 관리</li>
                            </ul>
                            <div style="background-color: #fdeaea; border-left: 4px solid #e74c3c; padding: 15px; margin: 15px 0; border-radius: 4px;">
                                <strong style="color: #c0392b;">⚠ 주의:</strong> 분쟁 진행 중인 고객의 데이터는 절대로 삭제하면 안 되며, 분쟁 해결 후에도 충분한 기간을 보유해야 합니다.
                            </div>
                        </div>
                    </div>

                    <div class="guide-section">
                        <h2 class="guide-h2">5. 체크리스트</h2>
                        <table class="guide-table">
                            <thead>
                                <tr>
                                    <th style="width: 70%;">점검 항목</th>
                                    <th>상태 확인</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>고객 데이터 상태 값 명확하게 설정되어 있는가?</td>
                                    <td>□</td>
                                </tr>
                                <tr>
                                    <td>심사탈락 고객 정보가 활성 고객과 분리되어 있는가?</td>
                                    <td>□</td>
                                </tr>
                                <tr>
                                    <td>거래종료 고객 데이터가 별도 공간에 보관되어 있는가?</td>
                                    <td>□</td>
                                </tr>
                                <tr>
                                    <td>파기 일정 기준(3년, 5년)이 명확한가?</td>
                                    <td>□</td>
                                </tr>
                                <tr>
                                    <td>정기적인 파기 담당자가 지정되어 있는가?</td>
                                    <td>□</td>
                                </tr>
                                <tr>
                                    <td>마케팅 동의 재동의 프로세스가 수립되어 있는가?</td>
                                    <td>□</td>
                                </tr>
                                <tr>
                                    <td>파기 기록을 남기는 대장이 준비되어 있는가?</td>
                                    <td>□</td>
                                </tr>
                                <tr>
                                    <td>분쟁 발생 시 절차가 정해져 있는가?</td>
                                    <td>□</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const fmt = new Intl.NumberFormat("ko-KR");
        let showLoanSchedule = false;
        let suppliers = [{ name: "", amounts: [""] }];
        let supplierCountValue = 2;
        let manualInputs = {};

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            const tabContent = document.getElementById(tabName);
            if (tabContent) {
                tabContent.classList.add('active');
            }
        }

        function formatNumberWithCommas(value) {
            return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        function parseFormattedNumber(value) {
            return Number(value.replace(/,/g, '')) || 0;
        }

        function handleLoanInput(event) {
            const input = event.target;
            const cursorPosition = input.selectionStart;
            const oldValue = input.value;
            const oldLength = oldValue.length;
            const numericValue = parseFormattedNumber(input.value);
            const formattedValue = numericValue > 0 ? formatNumberWithCommas(numericValue) : '';
            input.value = formattedValue;
            const newLength = formattedValue.length;
            const lengthDiff = newLength - oldLength;
            const newCursorPosition = cursorPosition + lengthDiff;
            setTimeout(() => {
                input.setSelectionRange(newCursorPosition, newCursorPosition);
            }, 0);
            calculateLoan();
        }

        function resetLoanCalc() {
            document.getElementById('loan').value = '';
            document.getElementById('annualRate').value = '';
            document.getElementById('principalPct').value = '';
            document.getElementById('months').value = '';
            document.getElementById('monthsError').classList.add('hidden');
            resetLoanDisplay();
            if (showLoanSchedule) {
                showLoanSchedule = false;
                document.getElementById('scheduleContainer').classList.add('hidden');
            }
            document.getElementById('scheduleBody').innerHTML = '';
        }

        function resetLoanDisplay() {
            document.getElementById('monthlyPrincipal').innerHTML = '<span class="text-slate-400">- 원</span>';
            document.getElementById('firstMonthPayment').innerHTML = '<span class="text-slate-400">- 원</span>';
            document.getElementById('firstMonthBreakdown').innerHTML = '<span class="text-slate-500">(원금 + 이자)</span>';
            document.getElementById('finalMonthPayment').innerHTML = '<span class="text-slate-400">- 원</span>';
            document.getElementById('finalMonthBreakdown').innerHTML = '<span class="text-slate-500">(원금 + 이자)</span>';
            document.getElementById('principalPortion').innerHTML = '<span class="text-slate-400">- 원</span>';
            document.getElementById('monthlyPrincipalFixed').innerHTML = '<span class="text-slate-400">- 원</span>';
            document.getElementById('finalBalloonPrincipal').innerHTML = '<span class="text-slate-400">- 원</span>';
            document.getElementById('monthlyRate').innerHTML = '<span class="text-slate-400">-%</span>';
            document.getElementById('totalInterest').innerHTML = '<span class="text-slate-400">- 원</span>';
            document.getElementById('totalPaid').innerHTML = '<span class="text-slate-400">- 원</span>';
        }

        function calculateLoan() {
            const loan = parseFormattedNumber(document.getElementById('loan').value);
            const annualRate = Number(document.getElementById('annualRate').value) || 0;
            const principalPct = Math.max(0, Math.min(100, Number(document.getElementById('principalPct').value) || 0));
            const months = Number(document.getElementById('months').value) || 0;

            if (!loan || !annualRate || !principalPct || !months) {
                resetLoanDisplay();
                return;
            }

            if (months <= 0) {
                document.getElementById('monthsError').classList.remove('hidden');
                resetLoanDisplay();
                return;
            } else {
                document.getElementById('monthsError').classList.add('hidden');
            }

            const monthlyRate = annualRate > 0 ? annualRate / 100 / 12 : 0;
            const principalPortion = loan * (principalPct / 100);
            const monthlyPrincipal = months > 0 ? principalPortion / months : 0;
            const firstMonthInterest = loan * monthlyRate;
            const firstMonthPayment = monthlyPrincipal + firstMonthInterest;
            const balanceBeforeFinal = loan - monthlyPrincipal * Math.max(0, months - 1);
            const finalBalloonPrincipal = loan - principalPortion;
            const finalMonthInterest = balanceBeforeFinal * monthlyRate;
            const finalMonthPrincipal = months > 0 ? monthlyPrincipal + finalBalloonPrincipal : 0;
            const finalMonthPayment = finalMonthPrincipal + finalMonthInterest;

            let totalInterest = 0;
            const schedule = [];

            for (let i = 0; i < Math.max(0, months); i++) {
                const m = i + 1;
                const balAtStart = loan - monthlyPrincipal * i;
                const interest = balAtStart * monthlyRate;
                const principal = m === months ? monthlyPrincipal + finalBalloonPrincipal : monthlyPrincipal;
                const payment = principal + interest;
                const balAtEnd = m === months ? 0 : balAtStart - monthlyPrincipal;
                totalInterest += interest;
                schedule.push({ m, balAtStart, principal, interest, payment, balAtEnd });
            }

            const totalPaid = loan + totalInterest;

            document.getElementById('monthlyPrincipal').textContent = fmt.format(Math.round(monthlyPrincipal)) + ' 원';
            document.getElementById('firstMonthPayment').textContent = fmt.format(Math.round(firstMonthPayment)) + ' 원';
            document.getElementById('firstMonthBreakdown').textContent =
                `(원금 ${fmt.format(Math.round(monthlyPrincipal))} + 이자 ${fmt.format(Math.round(firstMonthInterest))})`;
            document.getElementById('finalMonthPayment').textContent = fmt.format(Math.round(finalMonthPayment)) + ' 원';
            document.getElementById('finalMonthBreakdown').textContent =
                `(원금 ${fmt.format(Math.round(finalMonthPrincipal))} + 이자 ${fmt.format(Math.round(finalMonthInterest))})`;
            document.getElementById('principalPortion').textContent = fmt.format(Math.round(principalPortion)) + ' 원';
            document.getElementById('monthlyPrincipalFixed').textContent = fmt.format(Math.round(monthlyPrincipal)) + ' 원';
            document.getElementById('finalBalloonPrincipal').textContent = fmt.format(Math.round(finalBalloonPrincipal)) + ' 원';
            document.getElementById('monthlyRate').textContent = (monthlyRate * 100 || 0).toFixed(4) + '%';
            document.getElementById('totalInterest').textContent = fmt.format(Math.round(totalInterest)) + ' 원';
            document.getElementById('totalPaid').textContent = fmt.format(Math.round(totalPaid)) + ' 원';

            updateScheduleTable(schedule);
        }

        function updateScheduleTable(schedule) {
            const tbody = document.getElementById('scheduleBody');
            tbody.innerHTML = '';
            schedule.forEach(row => {
                const tr = document.createElement('tr');
                tr.className = 'border-t';
                tr.innerHTML = `
                    <td class="p-3">${row.m}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.balAtStart))}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.principal))}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.interest))}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.payment))}</td>
                    <td class="p-3 text-right">${fmt.format(Math.round(row.balAtEnd))}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function toggleLoanSchedule() {
            showLoanSchedule = !showLoanSchedule;
            const container = document.getElementById('scheduleContainer');
            if (showLoanSchedule) {
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        }

        function parseNumber(value) {
            return parseInt((value ?? '').toString().replace(/,/g, "")) || 0;
        }

        function formatNumber(value) {
            const num = parseNumber(value);
            if (num === 0 && (value === "" || value === 0)) return "";
            return num.toLocaleString();
        }

        function sanitizeNumber(value) {
            return value.replace(/[^0-9,]/g, "");
        }

        function sanitizeDecimal(value) {
            return value.replace(/[^0-9.]/g, "");
        }

        function addSupplier() {
            suppliers.push({ name: "", amounts: [""] });
            renderSuppliers();
        }

        function removeSupplier(index) {
            suppliers.splice(index, 1);
            renderSuppliers();
        }

        function updateSupplierName(index, name) {
            suppliers[index].name = name;
            renderSuppliers();
        }

        function updateAmount(supplierIndex, amountIndex, amount) {
            const cleanValue = sanitizeNumber(amount);
            suppliers[supplierIndex].amounts[amountIndex] = cleanValue;
            const inputId = `amount-${supplierIndex}-${amountIndex}`;
            const inputElement = document.getElementById(inputId);
            if (inputElement && document.activeElement !== inputElement) {
                inputElement.value = formatNumber(cleanValue);
            }
            renderSuppliers();
        }

        function addAmountField(supplierIndex) {
            suppliers[supplierIndex].amounts.push("");
            renderSuppliers();
        }

        function removeAmountField(supplierIndex, amountIndex) {
            if (suppliers[supplierIndex].amounts.length > 1) {
                suppliers[supplierIndex].amounts.splice(amountIndex, 1);
                renderSuppliers();
            }
        }

        function getSupplierTotal(amounts) {
            return amounts.reduce((sum, amount) => sum + parseNumber(amount), 0);
        }

        function renderSuppliers() {
            const container = document.getElementById('suppliers-container');
            container.innerHTML = '';
            suppliers.forEach((supplier, supplierIndex) => {
                const supplierDiv = document.createElement('div');
                supplierDiv.className = 'bg-slate-50 rounded-lg p-4 mb-4 border border-slate-200';

                let amountFields = '';
                supplier.amounts.forEach((amount, amountIndex) => {
                    amountFields += `
                        <div class="mb-3">
                            <label class="text-sm text-slate-600">금액</label>
                            <div class="flex gap-2">
                                <input type="text"
                                       id="amount-${supplierIndex}-${amountIndex}"
                                       value="${formatNumber(amount)}"
                                       oninput="updateAmount(${supplierIndex}, ${amountIndex}, this.value)"
                                       class="flex-1 border rounded-lg px-3 py-2"
                                       placeholder="금액을 입력하세요">
                                ${supplier.amounts.length > 1 ?
                                    `<button onclick="removeAmountField(${supplierIndex}, ${amountIndex})" class="px-3 py-2 bg-red-500 text-white rounded-lg text-sm hover:bg-red-600">삭제</button>` :
                                    ''
                                }
                            </div>
                        </div>
                    `;
                });

                supplierDiv.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex-1">
                            <label class="text-sm text-slate-600">공급자명</label>
                            <input type="text"
                                   value="${supplier.name}"
                                   oninput="updateSupplierName(${supplierIndex}, this.value)"
                                   class="w-full border rounded-lg px-3 py-2"
                                   placeholder="공급자명을 입력하세요">
                        </div>
                        ${suppliers.length > 1 ?
                            `<button onclick="removeSupplier(${supplierIndex})" class="ml-2 mt-6 px-3 py-2 bg-red-500 text-white rounded-lg text-sm hover:bg-red-600">공급자 삭제</button>` :
                            ''
                        }
                    </div>
                    ${amountFields}
                    <button onclick="addAmountField(${supplierIndex})" class="text-sm px-3 py-1 bg-slate-300 rounded-lg hover:bg-slate-400">
                        금액 필드 추가
                    </button>
                    <div class="mt-3 p-2 bg-blue-50 rounded-lg border border-blue-200">
                        <span class="font-semibold text-blue-900">${supplier.name || "공급자"} 합계: ${getSupplierTotal(supplier.amounts).toLocaleString()} 원</span>
                    </div>
                `;

                container.appendChild(supplierDiv);
            });
        }

        function getDistSuppliers() {
            return Array.from({ length: supplierCountValue }, (_, i) => String.fromCharCode(65 + i));
        }

        function getFinalAmount(key) {
            const base = parseNumber(document.getElementById('manualTotal').value);
            const distSuppliers = getDistSuppliers();
            const manualKeys = distSuppliers.filter(k => manualInputs[k] && manualInputs[k] !== "");
            const manualSum = manualKeys.reduce((sum, k) => sum + parseNumber(manualInputs[k]), 0);
            const remaining = base - manualSum;
            const autoCount = supplierCountValue - manualKeys.length;

            if (manualInputs[key] && manualInputs[key] !== "") {
                return parseNumber(manualInputs[key]);
            } else if (autoCount > 0) {
                return Math.floor(remaining / autoCount);
            } else {
                return 0;
            }
        }

        function getTotalDistributed() {
            return getDistSuppliers().reduce((sum, key) => sum + getFinalAmount(key), 0);
        }

        function updateDistribution() {
            const input = document.getElementById('manualTotal');
            const rawValue = input.value;
            input.value = formatNumber(rawValue);
            renderDistributionTable();
        }

        function changeSupplierCount(delta) {
            const newCount = Math.max(1, Math.min(26, supplierCountValue + delta));
            document.getElementById('supplierCount').value = newCount;
            updateSupplierCount();
        }

        function updateSupplierCount() {
            const input = document.getElementById('supplierCount');
            const val = parseInt(input.value.replace(/[^0-9]/g, ""), 10);
            if (!isNaN(val) && val >= 1 && val <= 26) {
                supplierCountValue = val;
                updateManualInputsForNewCount();
                renderDistributionTable();
            }
        }

        function updateManualInputsForNewCount() {
            const newInputs = {};
            getDistSuppliers().forEach(key => {
                newInputs[key] = manualInputs[key] || "";
            });
            manualInputs = newInputs;
        }

        function updateManualInput(key, value) {
            const cleanValue = sanitizeNumber(value);
            manualInputs[key] = cleanValue;
            const inputElement = document.getElementById(`manual-${key}`);
            if (inputElement) {
                const cursorPos = inputElement.selectionStart;
                const formattedValue = formatNumber(cleanValue);
                inputElement.value = formattedValue;
                const newCursorPos = Math.min(cursorPos + (formattedValue.length - value.length), formattedValue.length);
                inputElement.setSelectionRange(newCursorPos, newCursorPos);
            }
            updateDistributionResults();
        }

        function renderDistributionTable() {
            const tbody = document.getElementById('distribution-table');
            const distSuppliers = getDistSuppliers();

            tbody.innerHTML = '';

            distSuppliers.forEach((key, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="p-3">공급자 ${key}</td>
                    <td class="p-3">
                        <input type="text"
                               value="${formatNumber(manualInputs[key] || "")}"
                               oninput="updateManualInput('${key}', this.value)"
                               id="manual-${key}"
                               class="w-full border rounded-lg px-2 py-1">
                    </td>
                    <td class="p-3">${getFinalAmount(key).toLocaleString()}원</td>
                `;
                tbody.appendChild(row);
            });

            updateDistributionSummary();
        }

        function updateDistributionResults() {
            const distSuppliers = getDistSuppliers();
            distSuppliers.forEach((key, index) => {
                const rows = document.querySelectorAll('#distribution-table tr');
                if (rows[index]) {
                    const cells = rows[index].querySelectorAll('td');
                    if (cells[2]) {
                        cells[2].textContent = `${getFinalAmount(key).toLocaleString()}원`;
                    }
                }
            });
            updateDistributionSummary();
        }

        function updateDistributionSummary() {
            const totalLoan = parseNumber(document.getElementById('manualTotal').value);
            const distributed = getTotalDistributed();
            const difference = distributed - totalLoan;

            document.getElementById('distribution-summary').textContent =
                `합계: ${distributed.toLocaleString()}원 / 오차: ${difference.toLocaleString()}원`;
        }

        function resetManualInputs() {
            manualInputs = {};
            getDistSuppliers().forEach(key => {
                manualInputs[key] = "";
            });
            document.getElementById('manualTotal').value = "";
            renderDistributionTable();
        }

        function calculateVAT() {
            const input = document.getElementById('vatInput');
            const rawValue = input.value;
            input.value = formatNumber(rawValue);

            const value = parseNumber(rawValue);
            if (value > 0) {
                const vat = Math.floor(value / 11);
                const supply = value - vat;
                document.getElementById('vatOutput').value = `${vat.toLocaleString()}원`;
                document.getElementById('supplyAmount').value = `${supply.toLocaleString()}원`;
            } else {
                document.getElementById('vatOutput').value = "";
                document.getElementById('supplyAmount').value = "";
            }
        }

        function resetVAT() {
            document.getElementById('vatInput').value = "";
            document.getElementById('vatOutput').value = "";
            document.getElementById('supplyAmount').value = "";
        }

        function calculateInterest() {
            const loanInput = document.getElementById('loanAmount');
            const rawLoanValue = loanInput.value;
            loanInput.value = formatNumber(rawLoanValue);

            const rateInput = document.getElementById('annualRate2');
            rateInput.value = sanitizeDecimal(rateInput.value);

            const yearsInput = document.getElementById('years');
            yearsInput.value = yearsInput.value.replace(/[^0-9]/g, "");

            const principalInManwon = parseNumber(rawLoanValue);
            const principal = principalInManwon * 10000;
            const rateValue = parseFloat(rateInput.value) || 0;
            const rate = rateValue / 100;
            const y = parseInt(yearsInput.value, 10) || 1;

            if (principal > 0 && rate > 0 && y > 0) {
                const year = Math.floor(principal * rate * y);
                const month = Math.floor(year / 12);
                const day = Math.floor(year / 365);

                document.getElementById('yearlyInterest').value = `${year.toLocaleString()}원`;
                document.getElementById('monthlyInterest').value = `${month.toLocaleString()}원`;
                document.getElementById('dailyInterest').value = `${day.toLocaleString()}원`;
            } else {
                document.getElementById('yearlyInterest').value = "";
                document.getElementById('monthlyInterest').value = "";
                document.getElementById('dailyInterest').value = "";
            }

            document.getElementById('yearlyLabel').textContent = `${y}년 이자`;
            updateDailyRateDisplay(rateValue);
        }

        function updateDailyRateDisplay(rateValue) {
            const displayDiv = document.getElementById('dailyRateDisplay');
            if (rateValue > 0) {
                const monthlyRate = (rateValue / 12).toFixed(3);
                const dailyRate = (rateValue / 365).toFixed(4);
                displayDiv.innerHTML = `연이율 <b>${rateValue}%</b>는 월 이자율 <b>${monthlyRate}%</b>, 일 이자율 <b>${dailyRate}%</b>입니다.`;
                displayDiv.classList.remove('hidden');
            } else {
                displayDiv.classList.add('hidden');
            }
        }

        function resetInterest() {
            document.getElementById('loanAmount').value = "";
            document.getElementById('annualRate2').value = "";
            document.getElementById('years').value = "1";
            document.getElementById('yearlyInterest').value = "";
            document.getElementById('monthlyInterest').value = "";
            document.getElementById('dailyInterest').value = "";
            document.getElementById('dailyRateDisplay').classList.add('hidden');
            document.getElementById('yearlyLabel').textContent = "1년 이자";
        }

        function calculateDateAddition() {
            const dateStart = document.getElementById('dateStart').value;
            const daysToAdd = parseInt(document.getElementById('daysToAdd').value) || 0;

            if (!dateStart) {
                document.getElementById('dateResult').value = '';
                return;
            }

            const date = new Date(dateStart);
            date.setDate(date.getDate() + daysToAdd);

            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const resultDate = `${year}-${month}-${day}`;

            document.getElementById('dateResult').value = resultDate;
        }

        function resetDateAddition() {
            document.getElementById('dateStart').value = '';
            document.getElementById('daysToAdd').value = '';
            document.getElementById('dateResult').value = '';
        }

        function calculateDateDifference() {
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;

            if (!dateFrom || !dateTo) {
                document.getElementById('dateDifference').value = '';
                return;
            }

            const from = new Date(dateFrom);
            const to = new Date(dateTo);

            const timeDifference = Math.abs(to - from);
            const daysDifference = Math.ceil(timeDifference / (1000 * 60 * 60 * 24));

            document.getElementById('dateDifference').value = `${daysDifference}일`;
        }

        function resetDateDifference() {
            document.getElementById('dateFrom').value = '';
            document.getElementById('dateTo').value = '';
            document.getElementById('dateDifference').value = '';
        }

        // 초기화
        renderSuppliers();
        renderDistributionTable();
        resetLoanDisplay();
    </script>
</body>
</html>
